<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¡€çµ±ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆãƒ†ã‚¹ãƒˆ</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .result { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 3px; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>è¡€çµ±ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆãƒ†ã‚¹ãƒˆ</h1>
    
    <div class="test-section">
        <h2>1. åŸºæœ¬çš„ãªè¡€çµ±åˆ†æãƒ†ã‚¹ãƒˆ</h2>
        <button onclick="testBasicPedigreeAnalysis()">å®Ÿè¡Œ</button>
        <div id="basicResults" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>2. è¡€çµ±ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢ãƒ†ã‚¹ãƒˆ</h2>
        <button onclick="testPedigreeSearch()">å®Ÿè¡Œ</button>
        <div id="searchResults" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>3. è·é›¢é©æ€§äºˆæ¸¬ãƒ†ã‚¹ãƒˆ</h2>
        <button onclick="testDistanceAptitude()">å®Ÿè¡Œ</button>
        <div id="distanceResults" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>4. è¡€çµ±çµ±è¨ˆãƒ¬ãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ</h2>
        <button onclick="testPedigreeStats()">å®Ÿè¡Œ</button>
        <div id="statsResults" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>5. é…åˆãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æãƒ†ã‚¹ãƒˆ</h2>
        <button onclick="testMatingPatterns()">å®Ÿè¡Œ</button>
        <div id="matingResults" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>6. è¡€çµ±æŠ½å‡ºæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h2>
        <textarea id="testData" style="width: 100%; height: 120px; font-family: monospace;" placeholder="netkeibaå½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘">1	1	
æ¶ˆ
ãƒ­ãƒ¼ãƒ‰ã‚«ãƒŠãƒ­ã‚¢
ãƒ™ãƒ©ã‚¸ã‚ªã‚ªãƒšãƒ©
ã‚¨ã‚¢ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ³
(ãƒãƒ¼ãƒ“ãƒ³ã‚¸ãƒ£ãƒ¼)
æ —æ±ãƒ»ä¸Šæ‘  
å…ˆä¸­9é€±
510kg(+2)
4.0 (1äººæ°—)
ç‰¡5é¹¿

2	2	
æ¶ˆ
ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆ
ãƒ‰ã‚¥ãƒ¬ãƒƒãƒ„ã‚¡
ãƒ¢ã‚¢ã‚¶ãƒ³ã‚»ã‚¤ã‚¯ãƒªãƒƒãƒ‰
(More Than Ready)
ç¾æµ¦ãƒ»å°¾é–¢  
å…ˆä¸­9é€±
468kg(å‰è¨ˆä¸)
6.7 (4äººæ°—)
ç‰¡5é’é¹¿</textarea>
        <button onclick="testPedigreeExtraction()">è¡€çµ±æŠ½å‡ºãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
        <div id="extractionResults" class="result"></div>
    </div>

    <script src="js/pedigreeDatabase.js"></script>
    <script src="js/dataConverter.js"></script>
    <script>
        function testBasicPedigreeAnalysis() {
            const results = document.getElementById('basicResults');
            results.innerHTML = '<h3>è¡€çµ±åˆ†æçµæœ:</h3>';
            
            console.log('=== åŸºæœ¬è¡€çµ±åˆ†æãƒ†ã‚¹ãƒˆ ===');
            
            // ãƒ†ã‚¹ãƒˆ1: ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆç”£é§’
            const test1 = PedigreeDatabase.analyzePedigree('ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆ', 'ã‚¨ã‚¢ã‚°ãƒ«ãƒ¼ãƒ´', 'ã‚µãƒ³ãƒ‡ãƒ¼ã‚µã‚¤ãƒ¬ãƒ³ã‚¹');
            console.log('ãƒ†ã‚¹ãƒˆ1 - ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆç”£é§’:', test1);
            results.innerHTML += `
                <h4>ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆ Ã— ã‚¨ã‚¢ã‚°ãƒ«ãƒ¼ãƒ´ (æ¯çˆ¶: ã‚µãƒ³ãƒ‡ãƒ¼ã‚µã‚¤ãƒ¬ãƒ³ã‚¹)</h4>
                <p>ç·åˆè©•ä¾¡: ${test1.overallRating.grade}ç´š (${test1.overallRating.totalScore}ç‚¹)</p>
                <p>çˆ¶ç³»åˆ†æ: ${test1.sireAnalysis.analysis}</p>
                <p>æ¯çˆ¶åˆ†æ: ${test1.damSireAnalysis.analysis}</p>
                <p>é…åˆç›¸æ€§: ${test1.matingAnalysis.compatibility}ç‚¹ - ${test1.matingAnalysis.analysis}</p>
                <p>æ¨å¥¨äº‹é …: ${test1.recommendations.join('ã€')}</p>
            `;
            
            // ãƒ†ã‚¹ãƒˆ2: ãƒ­ãƒ¼ãƒ‰ã‚«ãƒŠãƒ­ã‚¢ç”£é§’
            const test2 = PedigreeDatabase.analyzePedigree('ãƒ­ãƒ¼ãƒ‰ã‚«ãƒŠãƒ­ã‚¢', 'ãƒ€ãƒ³ã‚·ãƒ³ã‚°ãƒ–ãƒ¬ãƒ¼ãƒ´', 'ã‚¹ãƒˆãƒ¼ãƒ ã‚­ãƒ£ãƒƒãƒˆ');
            console.log('ãƒ†ã‚¹ãƒˆ2 - ãƒ­ãƒ¼ãƒ‰ã‚«ãƒŠãƒ­ã‚¢ç”£é§’:', test2);
            results.innerHTML += `
                <h4>ãƒ­ãƒ¼ãƒ‰ã‚«ãƒŠãƒ­ã‚¢ Ã— ãƒ€ãƒ³ã‚·ãƒ³ã‚°ãƒ–ãƒ¬ãƒ¼ãƒ´ (æ¯çˆ¶: ã‚¹ãƒˆãƒ¼ãƒ ã‚­ãƒ£ãƒƒãƒˆ)</h4>
                <p>ç·åˆè©•ä¾¡: ${test2.overallRating.grade}ç´š (${test2.overallRating.totalScore}ç‚¹)</p>
                <p>çˆ¶ç³»åˆ†æ: ${test2.sireAnalysis.analysis}</p>
                <p>é…åˆç›¸æ€§: ${test2.matingAnalysis.compatibility}ç‚¹ - ${test2.matingAnalysis.analysis}</p>
                <p>æœŸå¾…èƒ½åŠ›: ã‚¹ãƒ”ãƒ¼ãƒ‰${test2.expectedAbilities.speed}ã€èŠé©æ€§${test2.expectedAbilities.turf}ã€ãƒ€ãƒ¼ãƒˆé©æ€§${test2.expectedAbilities.dirt}</p>
            `;
            
            // ãƒ†ã‚¹ãƒˆ3: æœªç™»éŒ²è¡€çµ±
            const test3 = PedigreeDatabase.analyzePedigree('æœªçŸ¥ç¨®ç‰¡é¦¬', 'å¹³å‡¡ç‰é¦¬', 'æœªçŸ¥æ¯çˆ¶');
            console.log('ãƒ†ã‚¹ãƒˆ3 - æœªç™»éŒ²è¡€çµ±:', test3);
            results.innerHTML += `
                <h4>æœªçŸ¥ç¨®ç‰¡é¦¬ Ã— å¹³å‡¡ç‰é¦¬ (æ¯çˆ¶: æœªçŸ¥æ¯çˆ¶)</h4>
                <p>ç·åˆè©•ä¾¡: ${test3.overallRating.grade}ç´š (${test3.overallRating.totalScore}ç‚¹)</p>
                <p>åˆ†æ: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœªç™»éŒ²ã®è¡€çµ±ã¨ã—ã¦æ¨™æº–è©•ä¾¡</p>
            `;
        }
        
        function testPedigreeSearch() {
            const results = document.getElementById('searchResults');
            results.innerHTML = '<h3>æ¤œç´¢çµæœ:</h3>';
            
            console.log('=== è¡€çµ±æ¤œç´¢ãƒ†ã‚¹ãƒˆ ===');
            
            // ç¨®ç‰¡é¦¬æ¤œç´¢
            const searchResult1 = PedigreeDatabase.searchPedigree('ãƒ‡ã‚£ãƒ¼ãƒ—');
            console.log('æ¤œç´¢ã€Œãƒ‡ã‚£ãƒ¼ãƒ—ã€:', searchResult1);
            results.innerHTML += `<p>ã€Œãƒ‡ã‚£ãƒ¼ãƒ—ã€æ¤œç´¢: ${searchResult1.length}ä»¶ã®çµæœ</p>`;
            
            const searchResult2 = PedigreeDatabase.searchPedigree('ã‚µãƒ³ãƒ‡ãƒ¼');
            console.log('æ¤œç´¢ã€Œã‚µãƒ³ãƒ‡ãƒ¼ã€:', searchResult2);
            results.innerHTML += `<p>ã€Œã‚µãƒ³ãƒ‡ãƒ¼ã€æ¤œç´¢: ${searchResult2.length}ä»¶ã®çµæœ</p>`;
            
            searchResult1.forEach(result => {
                results.innerHTML += `<p>ãƒ»${result.name} (${result.type}): ${result.data.description || result.data.specialties}</p>`;
            });
        }
        
        function testDistanceAptitude() {
            const results = document.getElementById('distanceResults');
            results.innerHTML = '<h3>è·é›¢é©æ€§äºˆæ¸¬:</h3>';
            
            console.log('=== è·é›¢é©æ€§äºˆæ¸¬ãƒ†ã‚¹ãƒˆ ===');
            
            const pedigreeAnalysis = PedigreeDatabase.analyzePedigree('ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆ', 'ãƒ†ã‚¹ãƒˆç‰é¦¬', 'ã‚µãƒ³ãƒ‡ãƒ¼ã‚µã‚¤ãƒ¬ãƒ³ã‚¹');
            const distanceApt = PedigreeDatabase.predictDistanceAptitude(pedigreeAnalysis);
            console.log('è·é›¢é©æ€§äºˆæ¸¬:', distanceApt);
            
            results.innerHTML += '<h4>ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆç”£é§’ã®è·é›¢é©æ€§äºˆæ¸¬:</h4>';
            Object.entries(distanceApt).forEach(([distance, aptitude]) => {
                results.innerHTML += `<p>${distance}m: ${aptitude}ç‚¹</p>`;
            });
        }
        
        function testPedigreeStats() {
            const results = document.getElementById('statsResults');
            results.innerHTML = '<h3>è¡€çµ±çµ±è¨ˆ:</h3>';
            
            console.log('=== è¡€çµ±çµ±è¨ˆãƒ†ã‚¹ãƒˆ ===');
            
            const stats = PedigreeDatabase.generatePedigreeStatsReport();
            console.log('è¡€çµ±çµ±è¨ˆ:', stats);
            
            results.innerHTML += `
                <p>ç™»éŒ²ç¨®ç‰¡é¦¬æ•°: ${stats.totalStallions}é ­</p>
                <p>ç™»éŒ²æ¯çˆ¶æ•°: ${stats.totalBroodmareSires}é ­</p>
                <p>è¡€çµ±ç³»çµ±æ•°: ${stats.pedigreeLinesCount}ç³»çµ±</p>
                <p>å¹³å‡ç¨®ç‰¡é¦¬è©•ä¾¡: ${stats.averageRating}ç‚¹</p>
                <h4>ä¸Šä½ç¨®ç‰¡é¦¬:</h4>
            `;
            
            stats.topRatedStallions.forEach((stallion, index) => {
                results.innerHTML += `<p>${index + 1}ä½: ${stallion.name} (${stallion.rating}ç‚¹ - ${stallion.type})</p>`;
            });
            
            results.innerHTML += '<h4>å„ªå‹¢è¡€çµ±ç³»çµ±:</h4>';
            stats.dominantLines.forEach((line, index) => {
                results.innerHTML += `<p>${index + 1}ä½: ${line.name} (å‹¢åŠ›${(line.dominance * 100).toFixed(1)}% - è©•ä¾¡${line.rating}ç‚¹)</p>`;
            });
        }
        
        function testMatingPatterns() {
            const results = document.getElementById('matingResults');
            results.innerHTML = '<h3>é…åˆãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ:</h3>';
            
            console.log('=== é…åˆãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æãƒ†ã‚¹ãƒˆ ===');
            
            const patterns = [
                { sire: 'ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆ', dam: 'ã‚¹ãƒ”ãƒ¼ãƒ‰ç‰é¦¬', damSire: 'ãƒãƒ¼ã‚¶ãƒ³ãƒ†ãƒ¼ã‚¹ãƒˆ', expected: 'ã‚¹ãƒ”ãƒ¼ãƒ‰Ã—ç¬ç™ºåŠ›' },
                { sire: 'ã‚­ãƒ³ã‚°ã‚«ãƒ¡ãƒãƒ¡ãƒ', dam: 'ãƒ‘ãƒ¯ãƒ¼ç‰é¦¬', damSire: 'ãƒŸã‚¹ã‚¿ãƒ¼ãƒ—ãƒ­ã‚¹ãƒšã‚¯ã‚¿ãƒ¼', expected: 'ãƒ‘ãƒ¯ãƒ¼å¼·åŒ–' },
                { sire: 'ãƒ­ãƒ¼ãƒ‰ã‚«ãƒŠãƒ­ã‚¢', dam: 'ä¸‡èƒ½ç‰é¦¬', damSire: 'ã‚¹ãƒˆãƒ¼ãƒ ã‚­ãƒ£ãƒƒãƒˆ', expected: 'ä¸‡èƒ½Ã—ã‚¹ãƒ”ãƒ¼ãƒ‰' },
                { sire: 'ã‚¹ãƒ†ã‚¤ã‚´ãƒ¼ãƒ«ãƒ‰', dam: 'ã‚¹ã‚¿ãƒŸãƒŠç‰é¦¬', damSire: 'ã‚µãƒ³ãƒ‡ãƒ¼ã‚µã‚¤ãƒ¬ãƒ³ã‚¹', expected: 'ã‚¹ã‚¿ãƒŸãƒŠÃ—ç¬ç™ºåŠ›' }
            ];
            
            patterns.forEach((pattern, index) => {
                const analysis = PedigreeDatabase.analyzePedigree(pattern.sire, pattern.dam, pattern.damSire);
                console.log(`ãƒ‘ã‚¿ãƒ¼ãƒ³${index + 1}:`, analysis);
                
                results.innerHTML += `
                    <h4>ãƒ‘ã‚¿ãƒ¼ãƒ³${index + 1}: ${pattern.sire} Ã— ${pattern.dam}</h4>
                    <p>æœŸå¾…é…åˆ: ${pattern.expected}</p>
                    <p>å®Ÿéš›ã®åˆ†æ: ${analysis.matingAnalysis.analysis}</p>
                    <p>é…åˆãƒ‘ã‚¿ãƒ¼ãƒ³: ${analysis.matingAnalysis.pattern}</p>
                    <p>å¼·åŒ–ãƒã‚¤ãƒ³ãƒˆ: ${analysis.matingAnalysis.expectedStrengths.join('ã€')}</p>
                    <p>ç›¸æ€§è©•ä¾¡: ${analysis.matingAnalysis.compatibility}ç‚¹</p>
                `;
            });
        }
        
        // åˆæœŸåŒ–æ™‚ã«ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º
        console.log('=== è¡€çµ±ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆç’°å¢ƒ ===');
        console.log('åˆ©ç”¨å¯èƒ½ãªãƒ†ã‚¹ãƒˆé–¢æ•°:');
        console.log('- testBasicPedigreeAnalysis() : åŸºæœ¬è¡€çµ±åˆ†æ');
        console.log('- testPedigreeSearch() : è¡€çµ±æ¤œç´¢');
        console.log('- testDistanceAptitude() : è·é›¢é©æ€§äºˆæ¸¬');
        console.log('- testPedigreeStats() : çµ±è¨ˆãƒ¬ãƒãƒ¼ãƒˆ');
        console.log('- testMatingPatterns() : é…åˆãƒ‘ã‚¿ãƒ¼ãƒ³');
        console.log('');
        console.log('æ‰‹å‹•ãƒ†ã‚¹ãƒˆä¾‹:');
        console.log('const result = PedigreeDatabase.analyzePedigree("ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆ", "ã‚¨ã‚¢ã‚°ãƒ«ãƒ¼ãƒ´", "ã‚µãƒ³ãƒ‡ãƒ¼ã‚µã‚¤ãƒ¬ãƒ³ã‚¹");');
        console.log('console.log(result);');
        
        // è¡€çµ±æŠ½å‡ºãƒ†ã‚¹ãƒˆé–¢æ•°
        function testPedigreeExtraction() {
            const testData = document.getElementById('testData').value;
            const resultsDiv = document.getElementById('extractionResults');
            
            console.log('=== è¡€çµ±æŠ½å‡ºãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            console.log('å…¥åŠ›ãƒ‡ãƒ¼ã‚¿:', testData);
            
            try {
                // DataConverterã®è¡€çµ±æŠ½å‡ºæ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆ
                if (typeof DataConverter !== 'undefined' && DataConverter.parseNetkeibaData) {
                    const horses = DataConverter.parseNetkeibaData(testData);
                    console.log('DataConverterçµæœ:', horses);
                    
                    let html = '<h3>ğŸ“Š è¡€çµ±æŠ½å‡ºçµæœ (DataConverterä½¿ç”¨)</h3>';
                    horses.forEach((horse, index) => {
                        const pedigreeCount = [horse.sire, horse.dam, horse.damSire].filter(x => x).length;
                        const rate = ((pedigreeCount / 3) * 100).toFixed(1);
                        
                        html += `
                            <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0;">
                                <h4>é¦¬${index + 1}: ${horse.name || 'æœªæŠ½å‡º'}</h4>
                                <p><strong>çˆ¶:</strong> ${horse.sire || 'æœªæŠ½å‡º'}</p>
                                <p><strong>æ¯:</strong> ${horse.dam || 'æœªæŠ½å‡º'}</p>
                                <p><strong>æ¯çˆ¶:</strong> ${horse.damSire || 'æœªæŠ½å‡º'}</p>
                                <p><strong>ã‚ªãƒƒã‚º:</strong> ${horse.odds || 'æœªæŠ½å‡º'}å€</p>
                                <p><strong>è„šè³ª:</strong> ${horse.runningStyle || 'æœªæŠ½å‡º'}</p>
                                <p><strong>è¡€çµ±æŠ½å‡ºç‡:</strong> ${pedigreeCount}/3 (${rate}%)</p>
                                <p style="color: ${rate >= 80 ? 'green' : rate >= 50 ? 'orange' : 'red'};">
                                    ${rate >= 80 ? 'âœ… æŠ½å‡ºè‰¯å¥½' : rate >= 50 ? 'âš ï¸ æŠ½å‡ºä¸å®Œå…¨' : 'âŒ æŠ½å‡ºå¤±æ•—'}
                                </p>
                            </div>
                        `;
                    });
                    
                    // å…¨ä½“ã®çµ±è¨ˆ
                    const totalPedigree = horses.reduce((sum, horse) => {
                        return sum + [horse.sire, horse.dam, horse.damSire].filter(x => x).length;
                    }, 0);
                    const maxPedigree = horses.length * 3;
                    const overallRate = ((totalPedigree / maxPedigree) * 100).toFixed(1);
                    
                    html += `
                        <div style="background: #e6f3ff; padding: 15px; margin: 20px 0; border-radius: 5px;">
                            <h4>ğŸ“ˆ å…¨ä½“çµ±è¨ˆ</h4>
                            <p><strong>ç·åˆè¡€çµ±æŠ½å‡ºç‡:</strong> ${totalPedigree}/${maxPedigree} (${overallRate}%)</p>
                            <p><strong>æŠ½å‡ºã•ã‚ŒãŸé¦¬æ•°:</strong> ${horses.length}é ­</p>
                            <p><strong>å•é¡Œç‚¹:</strong> ${overallRate < 80 ? 'è¡€çµ±æŠ½å‡ºã«æ”¹å–„ãŒå¿…è¦' : 'æŠ½å‡ºè‰¯å¥½'}</p>
                        </div>
                    `;
                    
                    resultsDiv.innerHTML = html;
                } else {
                    resultsDiv.innerHTML = '<div style="color: red;">âŒ DataConverterãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“</div>';
                }
                
            } catch (error) {
                resultsDiv.innerHTML = `<div style="color: red;">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
                console.error('è¡€çµ±æŠ½å‡ºãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
            }
        }
    </script>
</body>
</html>