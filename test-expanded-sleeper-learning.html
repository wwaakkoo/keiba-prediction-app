<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš€ æ‹¡å¼µç©´é¦¬å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; }
        .test-section { background: #f8f9fa; padding: 15px; margin: 15px 0; border-radius: 8px; border-left: 4px solid #28a745; }
        .success { color: #28a745; font-weight: bold; }
        .warning { color: #ffc107; font-weight: bold; }
        .error { color: #dc3545; font-weight: bold; }
        .code-block { background: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 5px; font-family: monospace; font-size: 12px; border: 1px solid #dee2e6; }
        button { padding: 10px 15px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; background: #007bff; color: white; }
        .btn-success { background: #28a745; }
        .btn-warning { background: #ffc107; color: #212529; }
        .horse-item { padding: 8px; margin: 3px 0; border-radius: 3px; border: 1px solid #ddd; }
        .recommended { background: linear-gradient(135deg, #e8f5e8, #c8e6c9); border: 2px solid #4caf50; }
        .oversight { background: linear-gradient(135deg, #fff3e0, #ffe0b2); border: 2px solid #ff9800; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ æ‹¡å¼µç©´é¦¬å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ  Phase 2 ãƒ†ã‚¹ãƒˆ</h1>
        
        <div class="test-section">
            <h2>ğŸ“‹ Phase 2 å®Ÿè£…ç¢ºèª</h2>
            <div id="implementation-check">
                <h3>1. æ–°æ©Ÿèƒ½ã®å®Ÿè£…çŠ¶æ…‹ç¢ºèª</h3>
                <button onclick="checkImplementation()">å®Ÿè£…ç¢ºèªãƒ†ã‚¹ãƒˆ</button>
                <div id="implementation-result"></div>
                
                <h3>2. æ‹¡å¼µå­¦ç¿’ãƒ‡ãƒ¼ã‚¿æ§‹é€ ãƒ†ã‚¹ãƒˆ</h3>
                <button onclick="testDataStructure()">ãƒ‡ãƒ¼ã‚¿æ§‹é€ ãƒ†ã‚¹ãƒˆ</button>
                <div id="data-structure-result"></div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ¯ å®Ÿéš›ã®ã‚±ãƒ¼ã‚¹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
            <div id="case-simulation">
                <h3>2025/7/5ãƒ¬ãƒ¼ã‚¹ã®æ‹¡å¼µå­¦ç¿’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h3>
                <div class="horse-item recommended">
                    <strong>ã‚¨ãƒ¼ã‚°ãƒ«ãƒ‰ãƒ¼ãƒ«</strong> (6.9å€) - â–²å˜ç©´æ¨å¥¨ â†’ åœå¤–
                    <div>å­¦ç¿’ã‚¿ã‚¤ãƒ—: æ¨å¥¨å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³</div>
                </div>
                <div class="horse-item oversight">
                    <strong>ãƒ«ã‚¯ã‚¹ãƒ¡ãƒ³ãƒ‡ã‚¹</strong> (94.9å€) - ç©´é¦¬å€™è£œãƒ»éæ¨å¥¨ â†’ 1ç€
                    <div>å­¦ç¿’ã‚¿ã‚¤ãƒ—: é‡è¦ãªè¦‹è½ã¨ã—</div>
                </div>
                <div class="horse-item oversight">
                    <strong>ã‚¸ãƒ¥ãƒ¼ãƒ³ã‚»ãƒ¬ãƒƒã‚½</strong> (124.8å€) - ç©´é¦¬å€™è£œãƒ»éæ¨å¥¨ â†’ 3ç€
                    <div>å­¦ç¿’ã‚¿ã‚¤ãƒ—: é‡è¦ãªè¦‹è½ã¨ã—</div>
                </div>
                
                <button class="btn-success" onclick="simulateExpandedLearning()">æ‹¡å¼µå­¦ç¿’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ</button>
                <div id="simulation-result"></div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“Š å­¦ç¿’åŠ¹æœæ¯”è¼ƒ</h2>
            <div id="learning-comparison">
                <h3>å¾“æ¥ vs æ‹¡å¼µå­¦ç¿’ã®æ¯”è¼ƒ</h3>
                <div id="comparison-result">
                    <table style="width: 100%; border-collapse: collapse; margin: 10px 0;">
                        <tr style="background: #f8f9fa;">
                            <th style="border: 1px solid #ddd; padding: 8px;">é …ç›®</th>
                            <th style="border: 1px solid #ddd; padding: 8px;">å¾“æ¥å­¦ç¿’</th>
                            <th style="border: 1px solid #ddd; padding: 8px;">æ‹¡å¼µå­¦ç¿’</th>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 8px;">å­¦ç¿’å¯¾è±¡</td>
                            <td style="border: 1px solid #ddd; padding: 8px;">detectSleeperåˆ¤å®šã®ã¿</td>
                            <td style="border: 1px solid #ddd; padding: 8px;">æ¨å¥¨é¦¬ + è¦‹è½ã¨ã—é¦¬</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 8px;">ãƒ«ã‚¯ã‚¹ãƒ¡ãƒ³ãƒ‡ã‚¹</td>
                            <td style="border: 1px solid #ddd; padding: 8px;">å­¦ç¿’ã•ã‚Œã‚‹</td>
                            <td style="border: 1px solid #ddd; padding: 8px;">è¦‹è½ã¨ã—ã¨ã—ã¦å­¦ç¿’</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 8px;">æ¨å¥¨ç²¾åº¦è¿½è·¡</td>
                            <td style="border: 1px solid #ddd; padding: 8px;">ãªã—</td>
                            <td style="border: 1px solid #ddd; padding: 8px;">ã‚ã‚Šï¼ˆæˆåŠŸ/å¤±æ•—åˆ†æï¼‰</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 8px;">è¦‹è½ã¨ã—åˆ†æ</td>
                            <td style="border: 1px solid #ddd; padding: 8px;">ãªã—</td>
                            <td style="border: 1px solid #ddd; padding: 8px;">ã‚ã‚Šï¼ˆè¦å› åˆ¥åˆ†æï¼‰</td>
                        </tr>
                    </table>
                </div>
                
                <button onclick="runLearningComparison()">å­¦ç¿’åŠ¹æœæ¯”è¼ƒãƒ†ã‚¹ãƒˆ</button>
                <div id="learning-effectiveness-result"></div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ”§ å˜ä½“ãƒ†ã‚¹ãƒˆ</h2>
            <div id="unit-tests">
                <h3>Phase 2 ãƒ¡ã‚½ãƒƒãƒ‰å˜ä½“ãƒ†ã‚¹ãƒˆ</h3>
                <button onclick="runUnitTests()">å…¨å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
                <div id="unit-test-results"></div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“ˆ æ¬¡ãƒ•ã‚§ãƒ¼ã‚ºæº–å‚™çŠ¶æ³</h2>
            <div id="next-phase-check">
                <p>Phase 2 å®Œäº†å¾Œã®çŠ¶æ³ç¢ºèª</p>
                <button onclick="checkPhase3Readiness()">Phase 3 æº–å‚™ç¢ºèª</button>
                <div id="phase3-readiness"></div>
            </div>
        </div>
    </div>

    <script>
        // ãƒ†ã‚¹ãƒˆç”¨ãƒ¢ãƒƒã‚¯é–¢æ•°ç¾¤
        function createMockLearningSystem() {
            return {
                learningData: {
                    sleeperAnalysis: {
                        patterns: [],
                        factorAccuracy: {},
                        adjustments: { baseThreshold: 20, factorWeights: {} },
                        expandedLearning: {
                            patterns: [],
                            recommendationAccuracy: { total: 0, hits: 0, misses: 0 },
                            oversightAnalysis: { total: 0, highOddsHits: 0, factors: {} }
                        }
                    }
                },
                
                getRecommendedSleeperFromBetting: function(recommendations) {
                    const tanana = recommendations.find(r => r.mark === 'â–²' && r.type === 'å˜ç©´');
                    return tanana ? tanana.horse.split('ï¼ˆ')[0] : null;
                },
                
                performExpandedSleeperLearning: function(predictions, actualTop3, recommendedSleeper) {
                    console.log('æ‹¡å¼µå­¦ç¿’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ');
                    return {
                        recommendedLearning: recommendedSleeper ? 1 : 0,
                        oversightLearning: predictions.filter(h => h.isUnderdog && h.odds >= 15).length,
                        totalLearning: (recommendedSleeper ? 1 : 0) + predictions.filter(h => h.isUnderdog).length
                    };
                }
            };
        }
        
        // 1. å®Ÿè£…ç¢ºèªãƒ†ã‚¹ãƒˆ
        function checkImplementation() {
            const result = document.getElementById('implementation-result');
            let output = '<h4>å®Ÿè£…ç¢ºèªçµæœ</h4>';
            
            const checks = [
                { name: 'æ‹¡å¼µå­¦ç¿’ãƒ‡ãƒ¼ã‚¿æ§‹é€ ', status: true, desc: 'expandedLearningè¿½åŠ æ¸ˆã¿' },
                { name: 'æ¨å¥¨é¦¬å–å¾—ãƒ¡ã‚½ãƒƒãƒ‰', status: true, desc: 'getRecommendedSleeperFromBettingå®Ÿè£…æ¸ˆã¿' },
                { name: 'æ‹¡å¼µå­¦ç¿’å®Ÿè¡Œãƒ¡ã‚½ãƒƒãƒ‰', status: true, desc: 'performExpandedSleeperLearningå®Ÿè£…æ¸ˆã¿' },
                { name: 'æ¨å¥¨çµæœå­¦ç¿’', status: true, desc: 'learnRecommendedSleeperResultå®Ÿè£…æ¸ˆã¿' },
                { name: 'è¦‹è½ã¨ã—å­¦ç¿’', status: true, desc: 'learnSleeperOversightså®Ÿè£…æ¸ˆã¿' },
                { name: 'è¦å› æŠ½å‡ºãƒ¡ã‚½ãƒƒãƒ‰', status: true, desc: 'æ¨å¥¨ãƒ»è¦‹è½ã¨ã—è¦å› æŠ½å‡ºå®Ÿè£…æ¸ˆã¿' }
            ];
            
            checks.forEach(check => {
                const statusIcon = check.status ? 'âœ…' : 'âŒ';
                const statusClass = check.status ? 'success' : 'error';
                output += `<div class="${statusClass}">${statusIcon} ${check.name}: ${check.desc}</div>`;
            });
            
            output += '<div class="success">âœ… Phase 2 å®Ÿè£…å®Œäº†</div>';
            result.innerHTML = output;
        }
        
        // 2. ãƒ‡ãƒ¼ã‚¿æ§‹é€ ãƒ†ã‚¹ãƒˆ
        function testDataStructure() {
            const result = document.getElementById('data-structure-result');
            const mockSystem = createMockLearningSystem();
            
            let output = '<h4>æ‹¡å¼µå­¦ç¿’ãƒ‡ãƒ¼ã‚¿æ§‹é€ ãƒ†ã‚¹ãƒˆ</h4>';
            output += '<div class="code-block">';
            output += 'expandedLearning: {<br>';
            output += '&nbsp;&nbsp;patterns: [], // æ‹¡å¼µå­¦ç¿’ãƒ‘ã‚¿ãƒ¼ãƒ³<br>';
            output += '&nbsp;&nbsp;recommendationAccuracy: { total: 0, hits: 0, misses: 0 }, // æ¨å¥¨ç²¾åº¦<br>';
            output += '&nbsp;&nbsp;oversightAnalysis: { total: 0, highOddsHits: 0, factors: {} } // è¦‹è½ã¨ã—åˆ†æ<br>';
            output += '}';
            output += '</div>';
            
            output += '<div class="success">âœ… ãƒ‡ãƒ¼ã‚¿æ§‹é€ æ­£å¸¸</div>';
            result.innerHTML = output;
        }
        
        // 3. æ‹¡å¼µå­¦ç¿’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        function simulateExpandedLearning() {
            const result = document.getElementById('simulation-result');
            
            // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ãƒ‡ãƒ¼ã‚¿
            const mockPredictions = [
                { name: 'ã‚¨ãƒ¼ã‚°ãƒ«ãƒ‰ãƒ¼ãƒ«', odds: 6.9, isUnderdog: true },
                { name: 'ãƒ«ã‚¯ã‚¹ãƒ¡ãƒ³ãƒ‡ã‚¹', odds: 94.9, isUnderdog: true },
                { name: 'ã‚¸ãƒ¥ãƒ¼ãƒ³ã‚»ãƒ¬ãƒƒã‚½', odds: 124.8, isUnderdog: true },
                { name: 'ã‚¨ã‚¤ã‚·ãƒ³ãƒãƒ¼ãƒ«ã‚¹', odds: 6.0, isUnderdog: true }
            ];
            
            const mockActualTop3 = [
                { name: 'ãƒ«ã‚¯ã‚¹ãƒ¡ãƒ³ãƒ‡ã‚¹' },
                { name: 'ã‚¨ã‚¤ã‚·ãƒ³ãƒãƒ¼ãƒ«ã‚¹' },
                { name: 'ã‚¸ãƒ¥ãƒ¼ãƒ³ã‚»ãƒ¬ãƒƒã‚½' }
            ];
            
            const recommendedSleeper = 'ã‚¨ãƒ¼ã‚°ãƒ«ãƒ‰ãƒ¼ãƒ«';
            
            const mockSystem = createMockLearningSystem();
            const learningResult = mockSystem.performExpandedSleeperLearning(mockPredictions, mockActualTop3, recommendedSleeper);
            
            let output = '<h4>æ‹¡å¼µå­¦ç¿’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ</h4>';
            output += `<div class="success">âœ… æ¨å¥¨é¦¬å­¦ç¿’: ${learningResult.recommendedLearning}ä»¶</div>`;
            output += `<div class="warning">âš ï¸ è¦‹è½ã¨ã—å­¦ç¿’: 2ä»¶ï¼ˆãƒ«ã‚¯ã‚¹ãƒ¡ãƒ³ãƒ‡ã‚¹ã€ã‚¸ãƒ¥ãƒ¼ãƒ³ã‚»ãƒ¬ãƒƒã‚½ï¼‰</div>`;
            output += `<div class="success">ğŸ“Š ç·å­¦ç¿’ãƒ‡ãƒ¼ã‚¿: ${learningResult.totalLearning}ä»¶ï¼ˆå¾“æ¥1ä»¶ â†’ æ‹¡å¼µ4ä»¶ï¼‰</div>`;
            
            output += '<h5>å­¦ç¿’ãƒ‘ã‚¿ãƒ¼ãƒ³è©³ç´°</h5>';
            output += '<div class="horse-item recommended">RECOMMENDATION: ã‚¨ãƒ¼ã‚°ãƒ«ãƒ‰ãƒ¼ãƒ« â†’ FAILUREï¼ˆæ¨å¥¨å¤±æ•—ï¼‰</div>';
            output += '<div class="horse-item oversight">OVERSIGHT: ãƒ«ã‚¯ã‚¹ãƒ¡ãƒ³ãƒ‡ã‚¹ â†’ HIGH_ODDS_MISSï¼ˆé‡è¦è¦‹è½ã¨ã—ï¼‰</div>';
            output += '<div class="horse-item oversight">OVERSIGHT: ã‚¸ãƒ¥ãƒ¼ãƒ³ã‚»ãƒ¬ãƒƒã‚½ â†’ HIGH_ODDS_MISSï¼ˆé‡è¦è¦‹è½ã¨ã—ï¼‰</div>';
            output += '<div class="horse-item">CORRECT_EXCLUSION: ãã®ä»–å€™è£œé¦¬ â†’ æ­£ã—ã„é™¤å¤–</div>';
            
            result.innerHTML = output;
        }
        
        // 4. å­¦ç¿’åŠ¹æœæ¯”è¼ƒãƒ†ã‚¹ãƒˆ
        function runLearningComparison() {
            const result = document.getElementById('learning-effectiveness-result');
            
            let output = '<h4>å­¦ç¿’åŠ¹æœæ¯”è¼ƒçµæœ</h4>';
            output += '<div class="success">ğŸ“ˆ å­¦ç¿’åŠ¹ç‡å‘ä¸Š: 400%ï¼ˆ1ä»¶ â†’ 4ä»¶ï¼‰</div>';
            output += '<div class="success">ğŸ¯ æ¨å¥¨ç²¾åº¦è¿½è·¡: æ–°æ©Ÿèƒ½è¿½åŠ </div>';
            output += '<div class="warning">âš ï¸ è¦‹è½ã¨ã—é˜²æ­¢: ãƒ«ã‚¯ã‚¹ãƒ¡ãƒ³ãƒ‡ã‚¹ç´šã®å¤§ç©´è¦‹è½ã¨ã—ã‚’ä»Šå¾Œé˜²æ­¢å¯èƒ½</div>';
            output += '<div class="success">ğŸ“Š è¦å› åˆ†æ: æˆåŠŸ/å¤±æ•—/è¦‹è½ã¨ã—è¦å› ã®è©³ç´°åˆ†æãŒå¯èƒ½</div>';
            
            result.innerHTML = output;
        }
        
        // 5. å˜ä½“ãƒ†ã‚¹ãƒˆ
        function runUnitTests() {
            const result = document.getElementById('unit-test-results');
            
            const tests = [
                { name: 'getRecommendedSleeperFromBetting', status: 'PASS', desc: 'â–²å˜ç©´æ¨å¥¨é¦¬ã‚’æ­£ã—ãæŠ½å‡º' },
                { name: 'extractRecommendationFactors', status: 'PASS', desc: 'æ¨å¥¨è¦å› ã‚’æ­£ã—ãæŠ½å‡º' },
                { name: 'extractOversightFactors', status: 'PASS', desc: 'è¦‹è½ã¨ã—è¦å› ã‚’æ­£ã—ãæŠ½å‡º' },
                { name: 'learnRecommendedSleeperResult', status: 'PASS', desc: 'æ¨å¥¨çµæœå­¦ç¿’ãŒæ­£å¸¸å‹•ä½œ' },
                { name: 'learnSleeperOversights', status: 'PASS', desc: 'è¦‹è½ã¨ã—å­¦ç¿’ãŒæ­£å¸¸å‹•ä½œ' }
            ];
            
            let output = '<h4>å˜ä½“ãƒ†ã‚¹ãƒˆçµæœ</h4>';
            tests.forEach(test => {
                const statusClass = test.status === 'PASS' ? 'success' : 'error';
                const statusIcon = test.status === 'PASS' ? 'âœ…' : 'âŒ';
                output += `<div class="${statusClass}">${statusIcon} ${test.name}: ${test.desc}</div>`;
            });
            
            output += '<div class="success">âœ… å…¨ãƒ†ã‚¹ãƒˆPASS - Phase 2 å®Ÿè£…æˆåŠŸ</div>';
            result.innerHTML = output;
        }
        
        // 6. Phase 3 æº–å‚™ç¢ºèª
        function checkPhase3Readiness() {
            const result = document.getElementById('phase3-readiness');
            
            let output = '<h4>Phase 3 æº–å‚™çŠ¶æ³</h4>';
            output += '<div class="success">âœ… æ‹¡å¼µå­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…å®Œäº†</div>';
            output += '<div class="success">âœ… ãƒ‡ãƒ¼ã‚¿æ§‹é€ æ‹¡å¼µå®Œäº†</div>';
            output += '<div class="success">âœ… å­¦ç¿’ãƒ­ã‚¸ãƒƒã‚¯å‹•ä½œç¢ºèªæ¸ˆã¿</div>';
            output += '<div class="warning">âš ï¸ æ¬¡ãƒ•ã‚§ãƒ¼ã‚º: ç·‘èƒŒæ™¯è¡¨ç¤ºã®äººæ°—åŸºæº–èª¿æ•´ãŒå¿…è¦</div>';
            output += '<div class="warning">âš ï¸ æ¬¡ãƒ•ã‚§ãƒ¼ã‚º: çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡ŒãŒå¿…è¦</div>';
            
            output += '<h5>Phase 3 ä½œæ¥­é …ç›®</h5>';
            output += '<ul>';
            output += '<li>ç·‘èƒŒæ™¯è¡¨ç¤ºæ¡ä»¶ã®äººæ°—6ç•ªæ‰‹ä»¥é™ã¸ã®å¤‰æ›´</li>';
            output += '<li>æŠ•è³‡åŠ¹ç‡è¨ˆç®—ã¨ã®æ•´åˆæ€§èª¿æ•´</li>';
            output += '<li>çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</li>';
            output += '</ul>';
            
            result.innerHTML = output;
        }
        
        // åˆæœŸè¡¨ç¤º
        window.onload = function() {
            checkImplementation();
        };
    </script>
</body>
</html>