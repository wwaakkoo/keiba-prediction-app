<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>è¡€çµ±ã‚¹ãƒ†ãƒƒãƒ—ãƒ‡ãƒãƒƒã‚°</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .log { 
            background: #f8f9fa; 
            padding: 10px; 
            border-radius: 3px; 
            font-family: monospace; 
            font-size: 12px; 
            white-space: pre-wrap; 
            max-height: 500px; 
            overflow-y: auto; 
            border: 1px solid #ddd;
        }
        .step { color: #007bff; font-weight: bold; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>ğŸ” è¡€çµ±ã‚¹ãƒ†ãƒƒãƒ—ãƒ‡ãƒãƒƒã‚°</h1>
    <p>DataConverterã®è¡€çµ±æŠ½å‡ºãƒ—ãƒ­ã‚»ã‚¹ã‚’è©³ç´°ã«ãƒ­ã‚°å‡ºåŠ›</p>
    
    <button onclick="debugBloodlineExtraction()">è¡€çµ±ã‚¹ãƒ†ãƒƒãƒ—è©³ç´°ãƒ‡ãƒãƒƒã‚°å®Ÿè¡Œ</button>
    <div id="results"></div>

    <script src="js/dataConverter.js"></script>
    <script>
        function debugBloodlineExtraction() {
            const resultsDiv = document.getElementById('results');
            
            // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ï¼ˆ1é ­ç›®ã®ã¿ï¼‰
            const testData = `1\t1\t
æ¶ˆ
ãƒ­ãƒ¼ãƒ‰ã‚«ãƒŠãƒ­ã‚¢
ãƒ™ãƒ©ã‚¸ã‚ªã‚ªãƒšãƒ©
ã‚¨ã‚¢ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ³
(ãƒãƒ¼ãƒ“ãƒ³ã‚¸ãƒ£ãƒ¼)
æ —æ±ãƒ»ä¸Šæ‘  
å…ˆä¸­9é€±
510kg(+2)
4.0 (1äººæ°—)
ç‰¡5é¹¿

æ¨ªå±±å’Œ
58.0\t`;

            console.clear();
            console.log('=== è¡€çµ±ã‚¹ãƒ†ãƒƒãƒ—è©³ç´°ãƒ‡ãƒãƒƒã‚°é–‹å§‹ ===');
            
            try {
                // DataConverterã®parseAllHorsesWithPedigreeã‚’ç›´æ¥å‘¼ã³å‡ºã—
                const horses = DataConverter.parseAllHorsesWithPedigree(testData);
                
                let html = '<h3>ğŸ” è¡€çµ±ã‚¹ãƒ†ãƒƒãƒ—è©³ç´°ãƒ­ã‚°</h3>';
                
                if (horses.length > 0) {
                    const horse = horses[0];
                    
                    html += `
                        <h4>æŠ½å‡ºçµæœ</h4>
                        <p><strong>é¦¬å:</strong> ${horse.name || 'æœªæŠ½å‡º'}</p>
                        <p><strong>çˆ¶ç³»:</strong> ${horse.sire || 'æœªæŠ½å‡º'}</p>
                        <p><strong>æ¯ç³»:</strong> ${horse.dam || 'æœªæŠ½å‡º'}</p>
                        <p><strong>æ¯çˆ¶:</strong> ${horse.damSire || 'æœªæŠ½å‡º'}</p>
                    `;
                    
                    if (horse.processLog) {
                        html += '<h4>å‡¦ç†ãƒ­ã‚°</h4>';
                        html += `<div class="log">${horse.processLog.join('\n')}</div>`;
                    }
                    
                    // å„ã‚¹ãƒ†ãƒƒãƒ—ã§ã®åˆ¤å®šçµæœã‚’è¡¨ç¤º
                    html += '<h4>ğŸ“‹ å„è¡Œã®åˆ¤å®šè©³ç´°</h4>';
                    const lines = testData.split('\n').map(line => line.trim()).filter(line => line);
                    const testLines = ['æ¶ˆ', 'ãƒ­ãƒ¼ãƒ‰ã‚«ãƒŠãƒ­ã‚¢', 'ãƒ™ãƒ©ã‚¸ã‚ªã‚ªãƒšãƒ©', 'ã‚¨ã‚¢ãƒ«ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ³', '(ãƒãƒ¼ãƒ“ãƒ³ã‚¸ãƒ£ãƒ¼)'];
                    
                    testLines.forEach((line, index) => {
                        html += `<div style="border: 1px solid #ddd; padding: 8px; margin: 5px 0;">`;
                        html += `<strong>è¡Œ${index + 1}: "${line}"</strong><br>`;
                        html += `isMarkLine: ${DataConverter.isMarkLine ? DataConverter.isMarkLine(line) : 'ãƒ¡ã‚½ãƒƒãƒ‰ãªã—'}<br>`;
                        html += `isSire: ${DataConverter.isSire ? DataConverter.isSire(line) : 'ãƒ¡ã‚½ãƒƒãƒ‰ãªã—'}<br>`;
                        html += `isPotentialSire(step=1): ${DataConverter.isPotentialSire ? DataConverter.isPotentialSire(line, 1) : 'ãƒ¡ã‚½ãƒƒãƒ‰ãªã—'}<br>`;
                        html += `isPotentialHorseName: ${DataConverter.isPotentialHorseName ? DataConverter.isPotentialHorseName(line) : 'ãƒ¡ã‚½ãƒƒãƒ‰ãªã—'}<br>`;
                        html += `isMare: ${DataConverter.isMare ? DataConverter.isMare(line) : 'ãƒ¡ã‚½ãƒƒãƒ‰ãªã—'}<br>`;
                        html += `isPotentialMare(step=3): ${DataConverter.isPotentialMare ? DataConverter.isPotentialMare(line, 3) : 'ãƒ¡ã‚½ãƒƒãƒ‰ãªã—'}<br>`;
                        html += `extractDamSire: ${DataConverter.extractDamSire ? DataConverter.extractDamSire(line) : 'ãƒ¡ã‚½ãƒƒãƒ‰ãªã—'}`;
                        html += `</div>`;
                    });
                    
                } else {
                    html += '<p class="error">âŒ é¦¬ãƒ‡ãƒ¼ã‚¿ãŒæŠ½å‡ºã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ</p>';
                }
                
                resultsDiv.innerHTML = html;
                
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="error">
                        <h3>âŒ ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ</h3>
                        <p>${error.message}</p>
                        <pre>${error.stack}</pre>
                    </div>
                `;
                console.error('è¡€çµ±ã‚¹ãƒ†ãƒƒãƒ—ãƒ‡ãƒãƒƒã‚°ã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒ¡ã‚½ãƒƒãƒ‰ã®å­˜åœ¨ç¢ºèª
        document.addEventListener('DOMContentLoaded', function() {
            console.log('=== DataConverterãƒ¡ã‚½ãƒƒãƒ‰ç¢ºèª ===');
            console.log('parseAllHorsesWithPedigree:', typeof DataConverter?.parseAllHorsesWithPedigree);
            console.log('isMarkLine:', typeof DataConverter?.isMarkLine);
            console.log('isSire:', typeof DataConverter?.isSire);
            console.log('isPotentialSire:', typeof DataConverter?.isPotentialSire);
            console.log('isPotentialHorseName:', typeof DataConverter?.isPotentialHorseName);
            console.log('isMare:', typeof DataConverter?.isMare);
            console.log('isPotentialMare:', typeof DataConverter?.isPotentialMare);
            console.log('extractDamSire:', typeof DataConverter?.extractDamSire);
        });
    </script>
</body>
</html>