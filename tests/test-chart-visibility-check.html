<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>📊 グラフ表示確認テスト</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; }
        .step { background: #f8f9fa; padding: 15px; margin: 15px 0; border-radius: 8px; border-left: 4px solid #28a745; }
        .code-block { background: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 5px; font-family: monospace; font-size: 12px; border: 1px solid #dee2e6; }
        .success { color: #28a745; font-weight: bold; }
        .error { color: #dc3545; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>📊 グラフ表示確認テスト</h1>
        
        <div class="step">
            <h2>✅ 確認済み：システム正常動作</h2>
            <p>ログから以下が確認できています：</p>
            <ul>
                <li class="success">✅ 全チャート作成完了</li>
                <li class="success">✅ データ取得成功</li>
                <li class="success">✅ 初期化・更新正常</li>
            </ul>
        </div>
        
        <div class="step">
            <h2>🔍 グラフ表示状況確認</h2>
            <p>メインアプリで「💰 収益性分析」ボタンを押した後、コンソールで以下を実行してください：</p>
            
            <div class="code-block">
// グラフCanvas要素の確認
console.log('ROIChart:', document.getElementById('roiChart'));
console.log('underdogChart:', document.getElementById('underdogChart'));
console.log('riskReturnChart:', document.getElementById('riskReturnChart'));
console.log('efficiencyChart:', document.getElementById('efficiencyChart'));
            </div>
        </div>
        
        <div class="step">
            <h2>📏 グラフサイズ確認</h2>
            <p>Canvas要素のサイズを確認：</p>
            
            <div class="code-block">
// Canvas要素のサイズ確認
['roiChart', 'underdogChart', 'riskReturnChart', 'efficiencyChart'].forEach(id => {
    const canvas = document.getElementById(id);
    if (canvas) {
        console.log(`${id}:`, {
            width: canvas.width,
            height: canvas.height,
            style: canvas.style.cssText,
            visible: canvas.offsetWidth > 0 && canvas.offsetHeight > 0
        });
    } else {
        console.log(`${id}: 要素なし`);
    }
});
            </div>
        </div>
        
        <div class="step">
            <h2>🎨 CSS表示状態確認</h2>
            <p>親要素の表示状態を確認：</p>
            
            <div class="code-block">
// 親要素の表示状態確認
const profitabilityDashboard = document.getElementById('profitabilityDashboard');
if (profitabilityDashboard) {
    console.log('profitabilityDashboard:', {
        display: getComputedStyle(profitabilityDashboard).display,
        visibility: getComputedStyle(profitabilityDashboard).visibility,
        opacity: getComputedStyle(profitabilityDashboard).opacity,
        width: profitabilityDashboard.offsetWidth,
        height: profitabilityDashboard.offsetHeight
    });
} else {
    console.log('profitabilityDashboard: 要素なし');
}
            </div>
        </div>
        
        <div class="step">
            <h2>🔧 強制表示テスト</h2>
            <p>グラフを強制的に表示：</p>
            
            <div class="code-block">
// 強制表示テスト
const dashboard = document.getElementById('profitabilityDashboard');
if (dashboard) {
    dashboard.style.display = 'block';
    dashboard.style.visibility = 'visible';
    dashboard.style.opacity = '1';
    console.log('✅ 強制表示設定完了');
    
    // チャート再描画
    if (typeof ProfitabilityVisualizationSystem !== 'undefined') {
        ProfitabilityVisualizationSystem.refreshAllCharts();
        console.log('✅ チャート再描画完了');
    }
} else {
    console.log('❌ dashboard要素なし');
}
            </div>
        </div>
        
        <div class="step">
            <h2>📋 Chart.js インスタンス確認</h2>
            <p>実際のChart.jsオブジェクトを確認：</p>
            
            <div class="code-block">
// Chart.jsインスタンス確認
if (typeof ProfitabilityVisualizationSystem !== 'undefined') {
    const charts = ProfitabilityVisualizationSystem.getAllCharts();
    console.log('作成済みチャート数:', charts.size);
    charts.forEach((chart, key) => {
        console.log(`チャート ${key}:`, {
            type: chart.config?.type,
            data: chart.data?.datasets?.length || 0,
            canvas: chart.canvas?.id
        });
    });
} else {
    console.log('❌ ProfitabilityVisualizationSystem未定義');
}
            </div>
        </div>
        
        <div class="step">
            <h2>🎯 問題特定ガイド</h2>
            <h3>期待される結果：</h3>
            <ul>
                <li class="success">Canvas要素が存在し、width/height > 0</li>
                <li class="success">profitabilityDashboard の display が 'block'</li>
                <li class="success">4つのチャートインスタンスが存在</li>
            </ul>
            
            <h3>よくある問題と対処：</h3>
            <ul>
                <li><strong>Canvas要素が0x0サイズ</strong> → 親要素のCSSスタイル問題</li>
                <li><strong>display: none状態</strong> → 表示ロジック問題</li>
                <li><strong>Chart.jsインスタンスなし</strong> → 作成処理失敗</li>
            </ul>
        </div>
        
        <div style="margin-top: 30px; padding: 20px; background: #d1ecf1; border-radius: 10px;">
            <h3>📝 実行手順</h3>
            <ol>
                <li>メインアプリで「💰 収益性分析」ボタンをクリック</li>
                <li>F12で開発者ツールを開く</li>
                <li>上記のコードを順番に実行</li>
                <li>結果を報告</li>
            </ol>
        </div>
    </div>
</body>
</html>