# 血統抽出テスト - 分離版

このフォルダには血統抽出ロジックを独立してテストするためのファイルが含まれています。

## ファイル構成

### `pedigreeExtractor.js`
- 血統抽出専用のクラス
- 元の`dataConverter.js`から血統関連機能のみを分離
- シンプルで理解しやすい構造

### `test.html`
- 基本的なブラウザテストページ
- 事前定義されたテストデータでの動作確認

### `interactive-test.html` ⭐ **推奨**
- **インタラクティブブラウザテスト**
- 自由にデータを入力・編集可能
- 期待結果の設定と自動比較
- 複数のサンプルデータ
- 詳細な結果表示とログ

### `console-test.js`
- 基本的なNode.js用コンソールテスト

### `console-interactive.js` ⭐ **推奨**
- **インタラクティブコンソールテスト**
- メニュー選択によるサンプルテスト
- カスタムデータ入力モード
- 期待結果との自動比較

## 実行方法

### 🌐 ブラウザテスト（推奨）
```bash
# インタラクティブ版（入力機能付き）
firefox pedigree-test/interactive-test.html

# 基本版
firefox pedigree-test/test.html
```

### 💻 コンソールテスト
```bash
cd pedigree-test

# インタラクティブ版（推奨）
node console-interactive.js

# 基本版
node console-test.js
```

## テストデータ

以下の競馬データを使用してテストします：

```
1\t1\t
消
ロードカナロア        <- 1頭目の父系
ベラジオオペラ        <- 1頭目の馬名（母系ではない）
エアルーティーン      <- 1頭目の母系
(ハービンジャー)      <- 1頭目の母父
...

1\t2\t
消  
ドゥラメンテ          <- 2頭目の父系
ドゥレッツァ          <- 2頭目の馬名（母系ではない）
モアザンセイクリッド  <- 2頭目の母系
(More Than Ready)     <- 2頭目の母父
...
```

## 期待結果

| 馬番 | 馬名 | 父系 | 母系 | 母父 |
|------|------|------|------|------|
| 1 | ベラジオオペラ | ロードカナロア | エアルーティーン | ハービンジャー |
| 2 | ドゥレッツァ | ドゥラメンテ | モアザンセイクリッド | More Than Ready |

## デバッグ機能

- 詳細な処理ログ出力
- インデックス進行の追跡
- 各判定ステップの可視化
- 期待結果との詳細比較

## 問題分析

このテストで血統抽出の以下の問題を特定できます：

1. **インデックス進行問題**: i++の二重実行
2. **血統判定ロジック**: 父系・母系・母父の正確な識別
3. **馬名と母系の混同**: 同じ名前が馬名と母系に誤認される問題
4. **印行スキップ**: "消"などのマーク行の適切な処理