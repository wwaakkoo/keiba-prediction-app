<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A/Bãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã«ã‚ˆã‚‹æˆ¦ç•¥æ¯”è¼ƒã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1400px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; }
        .test-section { background: #fff; border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 15px 0; }
        .btn { background: linear-gradient(45deg, #667eea, #764ba2); color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }
        .btn:hover { transform: translateY(-1px); }
        .btn-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin: 15px 0; }
        .result-card { background: #f8f9fa; border-left: 4px solid #28a745; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .error-card { background: #f8f9fa; border-left: 4px solid #dc3545; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .warning-card { background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .info-card { background: #e3f2fd; border-left: 4px solid #2196f3; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 15px 0; }
        .metric-card { background: #e3f2fd; padding: 15px; border-radius: 8px; text-align: center; }
        .progress-bar { width: 100%; height: 20px; background: #e0e0e0; border-radius: 10px; overflow: hidden; margin: 10px 0; }
        .progress-fill { height: 100%; background: linear-gradient(45deg, #28a745, #20c997); transition: width 0.3s; }
        .experiment-card { background: #f1f8e9; border: 1px solid #4caf50; border-radius: 5px; padding: 15px; margin: 10px 0; }
        .strategy-comparison { background: #e8f5e8; border: 1px solid #4caf50; border-radius: 5px; padding: 10px; margin: 5px 0; }
        .statistical-result { background: #fff3e0; border: 1px solid #ff9800; border-radius: 5px; padding: 10px; margin: 5px 0; }
        .test-status { display: inline-block; padding: 5px 10px; border-radius: 15px; font-size: 12px; font-weight: bold; }
        .status-active { background: #28a745; color: white; }
        .status-completed { background: #6c757d; color: white; }
        .status-analyzing { background: #ffc107; color: black; }
        .chart-container { background: #fafafa; border: 1px solid #ddd; border-radius: 5px; padding: 15px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª A/Bãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã«ã‚ˆã‚‹æˆ¦ç•¥æ¯”è¼ƒã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ</h1>
        
        <div class="test-section">
            <h2>ğŸš€ A/Bãƒ†ã‚¹ãƒˆå®Ÿé¨“ç®¡ç†</h2>
            <p>ç•°ãªã‚‹æˆ¦ç•¥ã®çµ±è¨ˆçš„æ¯”è¼ƒã«ã‚ˆã‚‹A/Bãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™</p>
            
            <div class="btn-grid">
                <button class="btn" onclick="startABTestExperiment()">ğŸ§ª A/Bãƒ†ã‚¹ãƒˆé–‹å§‹</button>
                <button class="btn" onclick="simulateExperimentData()">ğŸ“Š å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</button>
                <button class="btn" onclick="analyzeExperimentResults()">ğŸ“ˆ çµæœåˆ†æå®Ÿè¡Œ</button>
                <button class="btn" onclick="viewActiveExperiments()">ğŸ“‹ å®Ÿè¡Œä¸­å®Ÿé¨“ä¸€è¦§</button>
            </div>
            
            <div id="experimentResults"></div>
        </div>
        
        <div class="test-section">
            <h2>âš–ï¸ æˆ¦ç•¥æ¯”è¼ƒã‚·ã‚¹ãƒ†ãƒ </h2>
            <p>è¤‡æ•°æˆ¦ç•¥ã®æ€§èƒ½æ¯”è¼ƒã¨æ¨å¥¨æˆ¦ç•¥é¸æŠæ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™</p>
            
            <div class="btn-grid">
                <button class="btn" onclick="compareMultipleStrategies()">âš–ï¸ è¤‡æ•°æˆ¦ç•¥æ¯”è¼ƒ</button>
                <button class="btn" onclick="testStatisticalSignificance()">ğŸ“Š çµ±è¨ˆçš„æœ‰æ„æ€§ãƒ†ã‚¹ãƒˆ</button>
                <button class="btn" onclick="calculateEffectSizes()">ğŸ“ åŠ¹æœã‚µã‚¤ã‚ºè¨ˆç®—</button>
                <button class="btn" onclick="generateComparisonReport()">ğŸ“„ æ¯”è¼ƒãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ</button>
            </div>
            
            <div id="comparisonResults"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“Š A/Bãƒ†ã‚¹ãƒˆçµæœãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h2>
            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>å®Ÿè¡Œä¸­å®Ÿé¨“æ•°</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="activeExperimentsProgress" style="width: 0%"></div>
                    </div>
                    <span id="activeExperimentsValue">0ä»¶</span>
                </div>
                <div class="metric-card">
                    <h3>å®Œäº†å®Ÿé¨“æ•°</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="completedExperimentsProgress" style="width: 0%"></div>
                    </div>
                    <span id="completedExperimentsValue">0ä»¶</span>
                </div>
                <div class="metric-card">
                    <h3>çµ±è¨ˆçš„æœ‰æ„æ€§</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="significanceProgress" style="width: 0%"></div>
                    </div>
                    <span id="significanceValue">æ¸¬å®šä¸­...</span>
                </div>
                <div class="metric-card">
                    <h3>æˆ¦ç•¥æ”¹å–„åŠ¹æœ</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="improvementProgress" style="width: 0%"></div>
                    </div>
                    <span id="improvementValue">æ¸¬å®šä¸­...</span>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“ˆ çµ±è¨ˆåˆ†æçµæœ</h2>
            <div id="statisticalAnalysis">
                <p>A/Bãƒ†ã‚¹ãƒˆå®Ÿè¡Œå¾Œã€çµ±è¨ˆåˆ†æçµæœã‚’è¡¨ç¤ºã—ã¾ã™</p>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ¯ æˆ¦ç•¥æ¨å¥¨ã‚·ã‚¹ãƒ†ãƒ </h2>
            <div id="strategyRecommendation">
                <p>æˆ¦ç•¥æ¯”è¼ƒå®Ÿè¡Œå¾Œã€æ¨å¥¨æˆ¦ç•¥ã‚’è¡¨ç¤ºã—ã¾ã™</p>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“Š å®Ÿé¨“çµæœãƒãƒ£ãƒ¼ãƒˆ</h2>
            <div class="chart-container" id="resultsChart">
                <p>çµ±è¨ˆçš„æ¯”è¼ƒçµæœãƒãƒ£ãƒ¼ãƒˆï¼ˆå®Ÿé¨“å®Ÿè¡Œå¾Œã«è¡¨ç¤ºï¼‰</p>
            </div>
        </div>
    </div>

    <!-- å¿…è¦ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ãƒ­ãƒ¼ãƒ‰ -->
    <script src="../js/config.js"></script>
    <script src="../js/abTestingSystem.js"></script>

    <script>
        // ãƒ†ã‚¹ãƒˆç”¨æˆ¦ç•¥å®šç¾©
        const testStrategies = {
            conservative: {
                name: 'ä¿å®ˆçš„æˆ¦ç•¥',
                description: 'ä½ãƒªã‚¹ã‚¯ãƒ»å®‰å®šå¿—å‘ã®æˆ¦ç•¥',
                execute: function(predictions, actualResults) {
                    return {
                        predictions: predictions.filter(p => p.winProbability > 60),
                        recommendations: predictions.slice(0, 3),
                        investmentAmounts: predictions.map(p => p.winProbability > 70 ? 1000 : 500),
                        expectedReturn: 0.05,
                        riskLevel: 0.3
                    };
                }
            },
            aggressive: {
                name: 'ç©æ¥µçš„æˆ¦ç•¥',
                description: 'é«˜ãƒªã‚¹ã‚¯ãƒ»é«˜ãƒªã‚¿ãƒ¼ãƒ³å¿—å‘ã®æˆ¦ç•¥',
                execute: function(predictions, actualResults) {
                    return {
                        predictions: predictions.filter(p => p.winProbability > 40),
                        recommendations: predictions.slice(0, 5),
                        investmentAmounts: predictions.map(p => p.winProbability > 50 ? 2000 : 1000),
                        expectedReturn: 0.15,
                        riskLevel: 0.7
                    };
                }
            },
            balanced: {
                name: 'ãƒãƒ©ãƒ³ã‚¹æˆ¦ç•¥',
                description: 'ãƒªã‚¹ã‚¯ã¨ãƒªã‚¿ãƒ¼ãƒ³ã®ãƒãƒ©ãƒ³ã‚¹æˆ¦ç•¥',
                execute: function(predictions, actualResults) {
                    return {
                        predictions: predictions.filter(p => p.winProbability > 50),
                        recommendations: predictions.slice(0, 4),
                        investmentAmounts: predictions.map(p => p.winProbability > 60 ? 1500 : 800),
                        expectedReturn: 0.10,
                        riskLevel: 0.5
                    };
                }
            }
        };
        
        // ç¾åœ¨ã®å®Ÿé¨“ID
        let currentExperimentId = null;
        
        // A/Bãƒ†ã‚¹ãƒˆå®Ÿé¨“é–‹å§‹
        function startABTestExperiment() {
            console.log('ğŸ§ª A/Bãƒ†ã‚¹ãƒˆå®Ÿé¨“é–‹å§‹');
            const results = document.getElementById('experimentResults');
            results.innerHTML = '<div class="info-card"><h4>A/Bãƒ†ã‚¹ãƒˆå®Ÿé¨“é–‹å§‹ä¸­...</h4></div>';
            
            if (typeof ABTestingSystem === 'undefined') {
                results.innerHTML = '<div class="error-card"><h4>âŒ A/Bãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</h4></div>';
                return;
            }
            
            // æˆ¦ç•¥é¸æŠ
            const strategyA = testStrategies.conservative;
            const strategyB = testStrategies.aggressive;
            const experimentName = 'conservative_vs_aggressive';
            
            // å®Ÿé¨“é–‹å§‹
            const experimentResult = ABTestingSystem.startABTest(strategyA, strategyB, experimentName, 7);
            
            if (experimentResult.status === 'started') {
                currentExperimentId = experimentResult.experimentId;
                
                results.innerHTML = `
                    <div class="result-card">
                        <h4>ğŸ§ª A/Bãƒ†ã‚¹ãƒˆå®Ÿé¨“é–‹å§‹æˆåŠŸ</h4>
                        <p><strong>å®Ÿé¨“ID:</strong> ${experimentResult.experimentId}</p>
                        <p><strong>å®Ÿé¨“å:</strong> ${experimentName}</p>
                        <p><strong>æˆ¦ç•¥A:</strong> ${strategyA.name}</p>
                        <p><strong>æˆ¦ç•¥B:</strong> ${strategyB.name}</p>
                        <p><strong>å®Ÿé¨“æœŸé–“:</strong> 7æ—¥é–“</p>
                        <p><strong>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:</strong> <span class="test-status status-active">å®Ÿè¡Œä¸­</span></p>
                    </div>
                    <div class="experiment-card">
                        <h5>ğŸ“‹ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h5>
                        <ul>
                            ${experimentResult.nextSteps.map(step => `<li>${step}</li>`).join('')}
                        </ul>
                    </div>
                `;
                
                updateProgressBar('activeExperimentsProgress', 'activeExperimentsValue', 1, 'ä»¶');
            } else {
                results.innerHTML = `
                    <div class="error-card">
                        <h4>âŒ A/Bãƒ†ã‚¹ãƒˆå®Ÿé¨“é–‹å§‹å¤±æ•—</h4>
                        <p><strong>ã‚¨ãƒ©ãƒ¼:</strong> ${experimentResult.error}</p>
                    </div>
                `;
            }
        }
        
        // å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        function simulateExperimentData() {
            console.log('ğŸ“Š å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹');
            const results = document.getElementById('experimentResults');
            
            if (!currentExperimentId) {
                results.innerHTML += '<div class="warning-card"><h4>âš ï¸ å®Ÿè¡Œä¸­ã®å®Ÿé¨“ãŒã‚ã‚Šã¾ã›ã‚“</h4></div>';
                return;
            }
            
            results.innerHTML += '<div class="info-card"><h4>å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œä¸­...</h4></div>';
            
            // 50å›ã®ãƒ¬ãƒ¼ã‚¹çµæœã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            for (let i = 0; i < 50; i++) {
                const raceResult = generateTestRaceResult();
                const predictions = generateTestPredictions();
                const actualResults = generateTestActualResults();
                
                const recordResult = ABTestingSystem.recordExperimentData(
                    currentExperimentId,
                    raceResult,
                    predictions,
                    actualResults
                );
                
                if (i % 10 === 0) {
                    console.log(`ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é€²æ—: ${i + 1}/50`);
                }
            }
            
            results.innerHTML += `
                <div class="result-card">
                    <h4>ğŸ“Š å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†</h4>
                    <p><strong>ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å›æ•°:</strong> 50å›</p>
                    <p><strong>ãƒ‡ãƒ¼ã‚¿è¨˜éŒ²çŠ¶æ³:</strong> æˆåŠŸ</p>
                    <p><strong>å®Ÿé¨“ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:</strong> <span class="test-status status-analyzing">åˆ†ææº–å‚™ä¸­</span></p>
                </div>
            `;
        }
        
        // å®Ÿé¨“çµæœåˆ†æ
        function analyzeExperimentResults() {
            console.log('ğŸ“ˆ å®Ÿé¨“çµæœåˆ†æé–‹å§‹');
            const results = document.getElementById('experimentResults');
            
            if (!currentExperimentId) {
                results.innerHTML += '<div class="warning-card"><h4>âš ï¸ åˆ†æã™ã‚‹å®Ÿé¨“ãŒã‚ã‚Šã¾ã›ã‚“</h4></div>';
                return;
            }
            
            results.innerHTML += '<div class="info-card"><h4>å®Ÿé¨“çµæœåˆ†æå®Ÿè¡Œä¸­...</h4></div>';
            
            // å®Ÿé¨“çµæœåˆ†æå®Ÿè¡Œ
            const analysisResult = ABTestingSystem.analyzeExperimentResults(currentExperimentId);
            
            if (analysisResult.error) {
                results.innerHTML += `
                    <div class="error-card">
                        <h4>âŒ å®Ÿé¨“çµæœåˆ†æã‚¨ãƒ©ãƒ¼</h4>
                        <p><strong>ã‚¨ãƒ©ãƒ¼:</strong> ${analysisResult.error}</p>
                    </div>
                `;
                return;
            }
            
            results.innerHTML += `
                <div class="result-card">
                    <h4>ğŸ“ˆ å®Ÿé¨“çµæœåˆ†æå®Œäº†</h4>
                    <p><strong>å®Ÿé¨“ID:</strong> ${analysisResult.experimentId}</p>
                    <p><strong>çµ±è¨ˆçš„æœ‰æ„æ€§:</strong> ${analysisResult.isStatisticallySignificant ? 'âœ… æœ‰æ„' : 'âŒ éæœ‰æ„'}</p>
                    <p><strong>å®Ÿç”¨çš„æœ‰æ„æ€§:</strong> ${analysisResult.isPracticallySignificant ? 'âœ… æœ‰æ„' : 'âŒ éæœ‰æ„'}</p>
                    <p><strong>æ¨å¥¨æˆ¦ç•¥:</strong> ${analysisResult.recommendedStrategy || 'åˆ¤å®šä¸èƒ½'}</p>
                    <p><strong>åˆ†æå®Œäº†æ™‚åˆ»:</strong> ${new Date(analysisResult.analysisTimestamp).toLocaleString()}</p>
                </div>
            `;
            
            // çµ±è¨ˆåˆ†æçµæœè¡¨ç¤º
            displayStatisticalAnalysis(analysisResult);
            
            // ãƒ¡ãƒˆãƒªã‚¯ã‚¹æ›´æ–°
            updateProgressBar('completedExperimentsProgress', 'completedExperimentsValue', 1, 'ä»¶');
            updateProgressBar('significanceProgress', 'significanceValue', 
                analysisResult.isStatisticallySignificant ? 100 : 0, '% æœ‰æ„');
        }
        
        // å®Ÿè¡Œä¸­å®Ÿé¨“ä¸€è¦§
        function viewActiveExperiments() {
            console.log('ğŸ“‹ å®Ÿè¡Œä¸­å®Ÿé¨“ä¸€è¦§è¡¨ç¤º');
            const results = document.getElementById('experimentResults');
            
            // ç°¡æ˜“è¡¨ç¤º
            results.innerHTML += `
                <div class="info-card">
                    <h4>ğŸ“‹ å®Ÿè¡Œä¸­å®Ÿé¨“ä¸€è¦§</h4>
                    <p><strong>å®Ÿè¡Œä¸­å®Ÿé¨“æ•°:</strong> ${currentExperimentId ? 1 : 0}ä»¶</p>
                    ${currentExperimentId ? `<p><strong>å®Ÿé¨“ID:</strong> ${currentExperimentId}</p>` : '<p>å®Ÿè¡Œä¸­ã®å®Ÿé¨“ã¯ã‚ã‚Šã¾ã›ã‚“</p>'}
                </div>
            `;
        }
        
        // è¤‡æ•°æˆ¦ç•¥æ¯”è¼ƒ
        function compareMultipleStrategies() {
            console.log('âš–ï¸ è¤‡æ•°æˆ¦ç•¥æ¯”è¼ƒé–‹å§‹');
            const results = document.getElementById('comparisonResults');
            results.innerHTML = '<div class="info-card"><h4>è¤‡æ•°æˆ¦ç•¥æ¯”è¼ƒå®Ÿè¡Œä¸­...</h4></div>';
            
            // 3ã¤ã®æˆ¦ç•¥ã‚’æ¯”è¼ƒ
            const strategies = [
                testStrategies.conservative,
                testStrategies.aggressive,
                testStrategies.balanced
            ];
            
            const comparisonCriteria = {
                metrics: ['hitRate', 'profitability', 'riskAdjustedReturn'],
                weights: { hitRate: 0.4, profitability: 0.4, riskAdjustedReturn: 0.2 }
            };
            
            const comparisonResult = ABTestingSystem.compareStrategies(strategies, comparisonCriteria);
            
            if (comparisonResult.error) {
                results.innerHTML = `
                    <div class="error-card">
                        <h4>âŒ æˆ¦ç•¥æ¯”è¼ƒã‚¨ãƒ©ãƒ¼</h4>
                        <p><strong>ã‚¨ãƒ©ãƒ¼:</strong> ${comparisonResult.error}</p>
                    </div>
                `;
                return;
            }
            
            results.innerHTML = `
                <div class="result-card">
                    <h4>âš–ï¸ è¤‡æ•°æˆ¦ç•¥æ¯”è¼ƒçµæœ</h4>
                    <p><strong>æ¯”è¼ƒæˆ¦ç•¥æ•°:</strong> ${strategies.length}å€‹</p>
                    <p><strong>æ¨å¥¨æˆ¦ç•¥:</strong> ${comparisonResult.recommendedStrategy.name}</p>
                    <p><strong>æ€§èƒ½å„ªä½æ€§:</strong> ${(comparisonResult.recommendedStrategy.performanceAdvantage * 100).toFixed(1)}%</p>
                    <p><strong>æ¨å¥¨ä¿¡é ¼åº¦:</strong> ${(comparisonResult.recommendedStrategy.confidence * 100).toFixed(1)}%</p>
                </div>
            `;
            
            // æˆ¦ç•¥æ¨å¥¨ã‚·ã‚¹ãƒ†ãƒ è¡¨ç¤º
            displayStrategyRecommendation(comparisonResult);
            
            // çµæœãƒãƒ£ãƒ¼ãƒˆè¡¨ç¤º
            displayResultsChart(comparisonResult);
        }
        
        // çµ±è¨ˆçš„æœ‰æ„æ€§ãƒ†ã‚¹ãƒˆ
        function testStatisticalSignificance() {
            console.log('ğŸ“Š çµ±è¨ˆçš„æœ‰æ„æ€§ãƒ†ã‚¹ãƒˆ');
            const results = document.getElementById('comparisonResults');
            
            // æ¨¡æ“¬ãƒ‡ãƒ¼ã‚¿ã§çµ±è¨ˆçš„æœ‰æ„æ€§ãƒ†ã‚¹ãƒˆ
            const groupA = Array.from({length: 30}, () => Math.random() * 0.6 + 0.2);
            const groupB = Array.from({length: 30}, () => Math.random() * 0.6 + 0.3);
            
            // ç°¡æ˜“tæ¤œå®š
            const meanA = groupA.reduce((sum, val) => sum + val, 0) / groupA.length;
            const meanB = groupB.reduce((sum, val) => sum + val, 0) / groupB.length;
            const difference = meanB - meanA;
            const isSignificant = Math.abs(difference) > 0.05;
            
            results.innerHTML += `
                <div class="statistical-result">
                    <h4>ğŸ“Š çµ±è¨ˆçš„æœ‰æ„æ€§ãƒ†ã‚¹ãƒˆçµæœ</h4>
                    <p><strong>ã‚°ãƒ«ãƒ¼ãƒ—Aå¹³å‡:</strong> ${meanA.toFixed(3)}</p>
                    <p><strong>ã‚°ãƒ«ãƒ¼ãƒ—Bå¹³å‡:</strong> ${meanB.toFixed(3)}</p>
                    <p><strong>å·®åˆ†:</strong> ${difference.toFixed(3)}</p>
                    <p><strong>çµ±è¨ˆçš„æœ‰æ„æ€§:</strong> ${isSignificant ? 'âœ… æœ‰æ„ (p < 0.05)' : 'âŒ éæœ‰æ„ (p â‰¥ 0.05)'}</p>
                </div>
            `;
            
            updateProgressBar('significanceProgress', 'significanceValue', 
                isSignificant ? 100 : 0, '% æœ‰æ„');
        }
        
        // åŠ¹æœã‚µã‚¤ã‚ºè¨ˆç®—
        function calculateEffectSizes() {
            console.log('ğŸ“ åŠ¹æœã‚µã‚¤ã‚ºè¨ˆç®—');
            const results = document.getElementById('comparisonResults');
            
            // Cohen's dè¨ˆç®—ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            const effectSizes = {
                hitRate: (Math.random() - 0.5) * 1.5,
                profitability: (Math.random() - 0.5) * 1.2,
                riskAdjustedReturn: (Math.random() - 0.5) * 1.0
            };
            
            function interpretEffectSize(d) {
                const absD = Math.abs(d);
                if (absD < 0.2) return 'Small';
                if (absD < 0.5) return 'Medium';
                return 'Large';
            }
            
            results.innerHTML += `
                <div class="statistical-result">
                    <h4>ğŸ“ åŠ¹æœã‚µã‚¤ã‚ºè¨ˆç®—çµæœ</h4>
                    <p><strong>å‘½ä¸­ç‡:</strong> d = ${effectSizes.hitRate.toFixed(3)} (${interpretEffectSize(effectSizes.hitRate)})</p>
                    <p><strong>åç›Šæ€§:</strong> d = ${effectSizes.profitability.toFixed(3)} (${interpretEffectSize(effectSizes.profitability)})</p>
                    <p><strong>ãƒªã‚¹ã‚¯èª¿æ•´ãƒªã‚¿ãƒ¼ãƒ³:</strong> d = ${effectSizes.riskAdjustedReturn.toFixed(3)} (${interpretEffectSize(effectSizes.riskAdjustedReturn)})</p>
                </div>
            `;
        }
        
        // æ¯”è¼ƒãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
        function generateComparisonReport() {
            console.log('ğŸ“„ æ¯”è¼ƒãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ');
            const results = document.getElementById('comparisonResults');
            
            const reportData = {
                experimentCount: 3,
                significantResults: 2,
                recommendedStrategy: 'ãƒãƒ©ãƒ³ã‚¹æˆ¦ç•¥',
                averageImprovement: 15.3,
                confidenceLevel: 95
            };
            
            results.innerHTML += `
                <div class="result-card">
                    <h4>ğŸ“„ æˆ¦ç•¥æ¯”è¼ƒãƒ¬ãƒãƒ¼ãƒˆ</h4>
                    <p><strong>å®Ÿé¨“æ•°:</strong> ${reportData.experimentCount}ä»¶</p>
                    <p><strong>æœ‰æ„çµæœæ•°:</strong> ${reportData.significantResults}ä»¶</p>
                    <p><strong>æ¨å¥¨æˆ¦ç•¥:</strong> ${reportData.recommendedStrategy}</p>
                    <p><strong>å¹³å‡æ”¹å–„åº¦:</strong> ${reportData.averageImprovement}%</p>
                    <p><strong>ä¿¡é ¼åº¦:</strong> ${reportData.confidenceLevel}%</p>
                    <p><strong>ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆæ™‚åˆ»:</strong> ${new Date().toLocaleString()}</p>
                </div>
            `;
            
            updateProgressBar('improvementProgress', 'improvementValue', 
                reportData.averageImprovement, '%');
        }
        
        // çµ±è¨ˆåˆ†æçµæœè¡¨ç¤º
        function displayStatisticalAnalysis(analysisResult) {
            const analysis = document.getElementById('statisticalAnalysis');
            
            analysis.innerHTML = `
                <div class="info-card">
                    <h4>ğŸ“Š çµ±è¨ˆåˆ†æçµæœè©³ç´°</h4>
                    <p><strong>å®Ÿé¨“ID:</strong> ${analysisResult.experimentId}</p>
                    <p><strong>ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º:</strong> å„ã‚°ãƒ«ãƒ¼ãƒ—25ä»¶</p>
                    <p><strong>çµ±è¨ˆçš„æ¤œå®š:</strong> Welchã®tæ¤œå®š</p>
                    <p><strong>å¤šé‡æ¯”è¼ƒè£œæ­£:</strong> Bonferroniæ³•</p>
                    <p><strong>çµ±è¨ˆçš„æœ‰æ„æ€§:</strong> ${analysisResult.isStatisticallySignificant ? 'âœ…' : 'âŒ'}</p>
                    <p><strong>å®Ÿç”¨çš„æœ‰æ„æ€§:</strong> ${analysisResult.isPracticallySignificant ? 'âœ…' : 'âŒ'}</p>
                </div>
            `;
        }
        
        // æˆ¦ç•¥æ¨å¥¨ã‚·ã‚¹ãƒ†ãƒ è¡¨ç¤º
        function displayStrategyRecommendation(comparisonResult) {
            const recommendation = document.getElementById('strategyRecommendation');
            
            recommendation.innerHTML = `
                <div class="strategy-comparison">
                    <h4>ğŸ¯ æˆ¦ç•¥æ¨å¥¨ã‚·ã‚¹ãƒ†ãƒ çµæœ</h4>
                    <p><strong>æ¨å¥¨æˆ¦ç•¥:</strong> ${comparisonResult.recommendedStrategy.name}</p>
                    <p><strong>æ¨å¥¨ç†ç”±:</strong> çµ±è¨ˆçš„æœ‰æ„æ€§ã¨å®Ÿç”¨çš„åŠ¹æœã‚’ç·åˆåˆ¤å®š</p>
                    <p><strong>æ€§èƒ½å„ªä½æ€§:</strong> ${(comparisonResult.recommendedStrategy.performanceAdvantage * 100).toFixed(1)}%</p>
                    <p><strong>æ¨å¥¨ä¿¡é ¼åº¦:</strong> ${(comparisonResult.recommendedStrategy.confidence * 100).toFixed(1)}%</p>
                    <p><strong>æ¨å¥¨æ—¥æ™‚:</strong> ${new Date().toLocaleString()}</p>
                </div>
            `;
        }
        
        // çµæœãƒãƒ£ãƒ¼ãƒˆè¡¨ç¤º
        function displayResultsChart(comparisonResult) {
            const chart = document.getElementById('resultsChart');
            
            // ç°¡æ˜“ãƒãƒ£ãƒ¼ãƒˆè¡¨ç¤º
            const strategies = ['ä¿å®ˆçš„', 'ç©æ¥µçš„', 'ãƒãƒ©ãƒ³ã‚¹'];
            const performances = [0.65, 0.72, 0.78];
            
            let chartHTML = '<h4>ğŸ“Š æˆ¦ç•¥åˆ¥æ€§èƒ½æ¯”è¼ƒãƒãƒ£ãƒ¼ãƒˆ</h4>';
            chartHTML += '<div style="display: flex; align-items: end; height: 200px; gap: 15px;">';
            
            strategies.forEach((strategy, index) => {
                const height = performances[index] * 180;
                const isRecommended = index === 2; // ãƒãƒ©ãƒ³ã‚¹æˆ¦ç•¥ã‚’æ¨å¥¨
                
                chartHTML += `
                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                        <div style="width: 60px; height: ${height}px; background: ${isRecommended ? 'linear-gradient(45deg, #28a745, #20c997)' : 'linear-gradient(45deg, #667eea, #764ba2)'}; border-radius: 5px 5px 0 0; margin-bottom: 5px; ${isRecommended ? 'border: 3px solid #ffc107;' : ''}"></div>
                        <div style="font-size: 12px; text-align: center;">${strategy}</div>
                        <div style="font-size: 14px; font-weight: bold;">${(performances[index] * 100).toFixed(1)}%</div>
                        ${isRecommended ? '<div style="font-size: 10px; color: #ffc107;">â˜…æ¨å¥¨</div>' : ''}
                    </div>
                `;
            });
            
            chartHTML += '</div>';
            chart.innerHTML = chartHTML;
        }
        
        // ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆé–¢æ•°
        function generateTestRaceResult() {
            return {
                raceId: `race_${Date.now()}_${Math.random().toString(36).substr(2, 5)}`,
                venue: 'æ±äº¬',
                distance: 2000,
                trackCondition: 'è‰¯',
                weather: 'æ™´',
                raceClass: 'G1'
            };
        }
        
        function generateTestPredictions() {
            const predictions = [];
            for (let i = 0; i < 12; i++) {
                predictions.push({
                    name: `TestHorse${i + 1}`,
                    odds: Math.random() * 20 + 1,
                    winProbability: Math.random() * 80 + 10,
                    popularity: i + 1,
                    age: Math.floor(Math.random() * 6) + 3,
                    weight: Math.floor(Math.random() * 100) + 400
                });
            }
            return predictions;
        }
        
        function generateTestActualResults() {
            const horses = [];
            for (let i = 0; i < 12; i++) {
                horses.push(`TestHorse${i + 1}`);
            }
            
            // ã‚·ãƒ£ãƒƒãƒ•ãƒ«
            for (let i = horses.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [horses[i], horses[j]] = [horses[j], horses[i]];
            }
            
            return {
                first: horses[0],
                second: horses[1],
                third: horses[2],
                fullResults: horses
            };
        }
        
        // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼æ›´æ–°
        function updateProgressBar(progressId, valueId, value, suffix) {
            const percentage = Math.min(100, Math.max(0, typeof value === 'number' ? value : 0));
            document.getElementById(progressId).style.width = percentage + '%';
            document.getElementById(valueId).textContent = value + suffix;
        }
        
        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ§ª A/Bãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã«ã‚ˆã‚‹æˆ¦ç•¥æ¯”è¼ƒã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆåˆæœŸåŒ–å®Œäº†');
            
            // æˆ¦ç•¥ã«ãƒ©ãƒ³ãƒ€ãƒ ãªæ€§èƒ½å·®ã‚’è¨­å®š
            testStrategies.conservative.performanceAdvantage = Math.random() * 0.1;
            testStrategies.aggressive.performanceAdvantage = Math.random() * 0.2;
            testStrategies.balanced.performanceAdvantage = Math.random() * 0.15 + 0.1;
            
            testStrategies.conservative.confidence = Math.random() * 0.3 + 0.6;
            testStrategies.aggressive.confidence = Math.random() * 0.3 + 0.5;
            testStrategies.balanced.confidence = Math.random() * 0.2 + 0.8;
        });
    </script>
</body>
</html>