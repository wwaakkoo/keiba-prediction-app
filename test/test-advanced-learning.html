<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜åº¦ãªå­¦ç¿’æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-title {
            color: #2196f3;
            border-bottom: 2px solid #2196f3;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .test-result {
            background: #f8f9fa;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .test-error {
            background: #fff5f5;
            border-left: 4px solid #dc3545;
            color: #dc3545;
        }
        .btn {
            background: linear-gradient(45deg, #2196f3, #1976d2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            opacity: 0.9;
        }
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .metric {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
        }
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #1976d2;
        }
        .metric-label {
            font-size: 14px;
            color: #666;
        }
    </style>
</head>
<body>
    <h1>ğŸ§  é«˜åº¦ãªå­¦ç¿’æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h1>
    
    <!-- ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ -->
    <div class="test-section">
        <h2 class="test-title">ğŸ“Š ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ</h2>
        <button class="btn" onclick="generateTestData()">ğŸ² ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ</button>
        <button class="btn" onclick="clearResults()">ğŸ—‘ï¸ çµæœã‚’ã‚¯ãƒªã‚¢</button>
        <div id="testDataResult" class="test-result" style="display:none;"></div>
    </div>
    
    <!-- ç‰¹å¾´é‡è‡ªå‹•ç™ºè¦‹ãƒ†ã‚¹ãƒˆ -->
    <div class="test-section">
        <h2 class="test-title">ğŸ” ç‰¹å¾´é‡è‡ªå‹•ç™ºè¦‹ãƒ†ã‚¹ãƒˆ</h2>
        <button class="btn" onclick="testFeatureDiscovery()">ğŸ§ª ç‰¹å¾´é‡ç™ºè¦‹ã‚’å®Ÿè¡Œ</button>
        <div id="featureResult" class="test-result" style="display:none;"></div>
    </div>
    
    <!-- ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å­¦ç¿’ãƒ†ã‚¹ãƒˆ -->
    <div class="test-section">
        <h2 class="test-title">ğŸ¯ ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å­¦ç¿’ãƒ†ã‚¹ãƒˆ</h2>
        <button class="btn" onclick="testEnsembleLearning()">ğŸ§ª ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«äºˆæ¸¬ã‚’å®Ÿè¡Œ</button>
        <div id="ensembleResult" class="test-result" style="display:none;"></div>
    </div>
    
    <!-- ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ -->
    <div class="test-section">
        <h2 class="test-title">âœ… ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ</h2>
        <button class="btn" onclick="testCrossValidation()">ğŸ§ª ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ</button>
        <div id="crossValidationResult" class="test-result" style="display:none;"></div>
    </div>
    
    <!-- éå­¦ç¿’é˜²æ­¢ãƒ†ã‚¹ãƒˆ -->
    <div class="test-section">
        <h2 class="test-title">âš ï¸ éå­¦ç¿’é˜²æ­¢ãƒ†ã‚¹ãƒˆ</h2>
        <button class="btn" onclick="testOverlearningDetection()">ğŸ§ª éå­¦ç¿’æ¤œå‡ºã‚’å®Ÿè¡Œ</button>
        <div id="overlearningResult" class="test-result" style="display:none;"></div>
    </div>
    
    <!-- çµ±åˆãƒ†ã‚¹ãƒˆ -->
    <div class="test-section">
        <h2 class="test-title">ğŸš€ çµ±åˆãƒ†ã‚¹ãƒˆ</h2>
        <button class="btn" onclick="runFullTest()">ğŸ§ª å…¨æ©Ÿèƒ½çµ±åˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ</button>
        <div class="metrics" id="testMetrics" style="display:none;">
            <div class="metric">
                <div class="metric-value" id="featureCount">-</div>
                <div class="metric-label">ç™ºè¦‹ç‰¹å¾´é‡æ•°</div>
            </div>
            <div class="metric">
                <div class="metric-value" id="ensembleAccuracy">-</div>
                <div class="metric-label">ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ç²¾åº¦</div>
            </div>
            <div class="metric">
                <div class="metric-value" id="validationScore">-</div>
                <div class="metric-label">æ¤œè¨¼ã‚¹ã‚³ã‚¢</div>
            </div>
            <div class="metric">
                <div class="metric-value" id="overlearningStatus">-</div>
                <div class="metric-label">éå­¦ç¿’çŠ¶æ…‹</div>
            </div>
        </div>
        <div id="fullTestResult" class="test-result" style="display:none;"></div>
    </div>

    <!-- EnhancedLearningSystemã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿ -->
    <script src="../js/config.js"></script>
    <script src="../js/enhancedLearningSystem.js"></script>
    
    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let testData = null;
        
        // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
        function generateTestData() {
            const result = document.getElementById('testDataResult');
            
            try {
                // ç«¶é¦¬ãƒ¬ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ
                testData = {
                    horses: []
                };
                
                const horseNames = ['ãƒ©ãƒƒã‚­ãƒ¼ãƒ›ãƒ¼ã‚¹', 'ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚¹ã‚¿ãƒ¼', 'ã‚´ãƒ¼ãƒ«ãƒ‰ãƒ©ãƒƒã‚·ãƒ¥', 'ã‚µãƒ³ãƒ€ãƒ¼ãƒœãƒ«ãƒˆ', 'ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰', 
                                 'ãƒ–ãƒ¬ã‚¤ãƒ–ãƒãƒ¼ãƒˆ', 'ã‚·ãƒ«ãƒãƒ¼ã‚¢ãƒ­ãƒ¼', 'ãƒ•ã‚¡ã‚¤ã‚¢ãƒ¼ã‚¹ãƒˆãƒ¼ãƒ ', 'ã‚¦ã‚£ãƒ³ãƒ‰ãƒã‚§ã‚¤ã‚µãƒ¼', 'ã‚¯ãƒªãƒ ã‚¾ãƒ³ãƒ•ãƒ¬ã‚¢'];
                const jockeys = ['æ­¦è±Š', 'ç¦æ°¸ç¥ä¸€', 'å·ç”°å°†é›…', 'æˆ¸å´åœ­å¤ª', 'æ¨ªå±±æ­¦å²'];
                const runningStyles = ['é€ƒã’', 'å…ˆè¡Œ', 'å·®ã—', 'è¿½è¾¼'];
                
                for (let i = 0; i < 10; i++) {
                    const horse = {
                        name: horseNames[i],
                        odds: (Math.random() * 50 + 1).toFixed(1),
                        popularity: i + 1,
                        age: Math.floor(Math.random() * 3) + 3, // 3-5æ­³
                        weight: (Math.random() * 10 + 450).toFixed(0), // 450-460kg
                        jockey: jockeys[Math.floor(Math.random() * jockeys.length)],
                        runningStyle: runningStyles[Math.floor(Math.random() * runningStyles.length)],
                        lastRace: {
                            position: Math.floor(Math.random() * 10) + 1,
                            time: `1:${Math.floor(Math.random() * 60) + 20}.${Math.floor(Math.random() * 9)}`,
                            date: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                            weight: (Math.random() * 10 + 450).toFixed(0)
                        },
                        raceHistory: []
                    };
                    
                    // ãƒ¬ãƒ¼ã‚¹å±¥æ­´ã‚’ç”Ÿæˆ
                    for (let j = 0; j < 3; j++) {
                        horse.raceHistory.push({
                            position: Math.floor(Math.random() * 8) + 1,
                            time: `1:${Math.floor(Math.random() * 60) + 20}.${Math.floor(Math.random() * 9)}`
                        });
                    }
                    
                    testData.horses.push(horse);
                }
                
                result.style.display = 'block';
                result.className = 'test-result';
                result.textContent = `âœ… ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå®Œäº†\n${testData.horses.length}é ­ã®é¦¬ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¾ã—ãŸã€‚\n\n` +
                    testData.horses.map((horse, i) => 
                        `${i+1}. ${horse.name} (${horse.odds}å€, ${horse.runningStyle}, ${horse.jockey})`
                    ).join('\n');
                    
            } catch (error) {
                result.style.display = 'block';
                result.className = 'test-result test-error';
                result.textContent = `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}\n${error.stack}`;
            }
        }
        
        // ç‰¹å¾´é‡è‡ªå‹•ç™ºè¦‹ãƒ†ã‚¹ãƒˆ
        function testFeatureDiscovery() {
            const result = document.getElementById('featureResult');
            
            if (!testData) {
                result.style.display = 'block';
                result.className = 'test-result test-error';
                result.textContent = 'âŒ å…ˆã«ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„';
                return;
            }
            
            try {
                console.log('ğŸ” ç‰¹å¾´é‡è‡ªå‹•ç™ºè¦‹ãƒ†ã‚¹ãƒˆé–‹å§‹');
                const discoveryResult = EnhancedLearningSystem.discoverFeatures(testData);
                
                result.style.display = 'block';
                result.className = 'test-result';
                
                let resultText = `âœ… ç‰¹å¾´é‡è‡ªå‹•ç™ºè¦‹ãƒ†ã‚¹ãƒˆå®Œäº†\n\n`;
                resultText += `ğŸ“Š ç™ºè¦‹ã•ã‚ŒãŸç‰¹å¾´é‡: ${Object.keys(discoveryResult.features).length}å€‹\n\n`;
                
                resultText += `ğŸ† ä¸Šä½10é‡è¦ç‰¹å¾´é‡:\n`;
                discoveryResult.topFeatures.slice(0, 10).forEach((feature, i) => {
                    resultText += `${i+1}. ${feature.name}: ${feature.importance.toFixed(3)} (å€¤: ${feature.value})\n`;
                });
                
                // ç‰¹å¾´é‡ã®ç¨®é¡åˆ¥çµ±è¨ˆ
                const featureTypes = {
                    basic: 0,
                    combined: 0,
                    statistical: 0
                };
                
                Object.keys(discoveryResult.features).forEach(name => {
                    if (name.includes('horse_')) featureTypes.basic++;
                    else if (name.includes('_mean') || name.includes('_std') || name.includes('_diversity')) featureTypes.combined++;
                    else featureTypes.statistical++;
                });
                
                resultText += `\nğŸ“ˆ ç‰¹å¾´é‡åˆ†é¡:\n`;
                resultText += `ãƒ»åŸºæœ¬ç‰¹å¾´é‡: ${featureTypes.basic}å€‹\n`;
                resultText += `ãƒ»è¤‡åˆç‰¹å¾´é‡: ${featureTypes.combined}å€‹\n`;
                resultText += `ãƒ»çµ±è¨ˆç‰¹å¾´é‡: ${featureTypes.statistical}å€‹\n`;
                
                result.textContent = resultText;
                
            } catch (error) {
                result.style.display = 'block';
                result.className = 'test-result test-error';
                result.textContent = `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}\n${error.stack}`;
            }
        }
        
        // ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å­¦ç¿’ãƒ†ã‚¹ãƒˆ
        function testEnsembleLearning() {
            const result = document.getElementById('ensembleResult');
            
            if (!testData) {
                result.style.display = 'block';
                result.className = 'test-result test-error';
                result.textContent = 'âŒ å…ˆã«ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„';
                return;
            }
            
            try {
                console.log('ğŸ¯ ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å­¦ç¿’ãƒ†ã‚¹ãƒˆé–‹å§‹');
                const ensembleResult = EnhancedLearningSystem.ensemblePredict(testData);
                
                result.style.display = 'block';
                result.className = 'test-result';
                
                let resultText = `âœ… ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å­¦ç¿’ãƒ†ã‚¹ãƒˆå®Œäº†\n\n`;
                resultText += `ğŸ¯ å…¨ä½“ä¿¡é ¼åº¦: ${(ensembleResult.confidence * 100).toFixed(1)}%\n\n`;
                
                resultText += `ğŸ† äºˆæ¸¬çµæœï¼ˆä¸Šä½5é ­ï¼‰:\n`;
                ensembleResult.predictions.slice(0, 5).forEach((pred, i) => {
                    resultText += `${i+1}ä½: ${pred.horse.name} (ã‚¹ã‚³ã‚¢: ${pred.ensemblePrediction.toFixed(3)}, ä¿¡é ¼åº¦: ${(pred.confidence * 100).toFixed(1)}%)\n`;
                    
                    // å„ãƒ¢ãƒ‡ãƒ«ã®äºˆæ¸¬ã‚’è¡¨ç¤º
                    const modelPreds = Object.entries(pred.predictions)
                        .map(([model, score]) => `${model}:${score.toFixed(2)}`)
                        .join(', ');
                    resultText += `  â”” ãƒ¢ãƒ‡ãƒ«äºˆæ¸¬: ${modelPreds}\n`;
                });
                
                resultText += `\nâš–ï¸ ãƒ¢ãƒ‡ãƒ«é‡ã¿:\n`;
                Object.entries(ensembleResult.modelWeights).forEach(([model, weight]) => {
                    resultText += `ãƒ»${model}: ${(weight * 100).toFixed(1)}%\n`;
                });
                
                result.textContent = resultText;
                
            } catch (error) {
                result.style.display = 'block';
                result.className = 'test-result test-error';
                result.textContent = `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}\n${error.stack}`;
            }
        }
        
        // ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ
        function testCrossValidation() {
            const result = document.getElementById('crossValidationResult');
            
            try {
                console.log('âœ… ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                // ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ
                const cvTestData = [];
                for (let i = 0; i < 50; i++) {
                    cvTestData.push({
                        features: {
                            odds: Math.random() * 20 + 1,
                            age: Math.floor(Math.random() * 3) + 3,
                            popularity: Math.floor(Math.random() * 10) + 1
                        },
                        actual: Math.random() > 0.7 // 30%ã®ç¢ºç‡ã§çš„ä¸­
                    });
                }
                
                const cvResult = EnhancedLearningSystem.performCrossValidation(cvTestData, 5);
                
                result.style.display = 'block';
                result.className = 'test-result';
                
                let resultText = `âœ… ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆå®Œäº†\n\n`;
                resultText += `ğŸ“Š ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿: ${cvTestData.length}ä»¶\n`;
                resultText += `ğŸ”„ åˆ†å‰²æ•°: 5åˆ†å‰²\n\n`;
                resultText += `ğŸ“ˆ çµæœ:\n`;
                resultText += `ãƒ»æ¤œè¨¼ã‚¹ã‚³ã‚¢: ${(cvResult.validationScore * 100).toFixed(1)}%\n`;
                resultText += `ãƒ»è¨“ç·´ã‚¹ã‚³ã‚¢: ${(cvResult.trainingScore * 100).toFixed(1)}%\n`;
                
                const overfittingGap = cvResult.trainingScore - cvResult.validationScore;
                resultText += `ãƒ»éå­¦ç¿’åº¦: ${(overfittingGap * 100).toFixed(1)}%\n`;
                
                if (overfittingGap > 0.1) {
                    resultText += `âš ï¸ éå­¦ç¿’ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼ˆå·®ãŒ10%ä»¥ä¸Šï¼‰\n`;
                } else {
                    resultText += `âœ… å¥å…¨ãªå­¦ç¿’çŠ¶æ…‹ã§ã™\n`;
                }
                
                result.textContent = resultText;
                
            } catch (error) {
                result.style.display = 'block';
                result.className = 'test-result test-error';
                result.textContent = `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}\n${error.stack}`;
            }
        }
        
        // éå­¦ç¿’é˜²æ­¢ãƒ†ã‚¹ãƒˆ
        function testOverlearningDetection() {
            const result = document.getElementById('overlearningResult');
            
            try {
                console.log('âš ï¸ éå­¦ç¿’é˜²æ­¢ãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                let resultText = `âœ… éå­¦ç¿’é˜²æ­¢ãƒ†ã‚¹ãƒˆå®Œäº†\n\n`;
                
                // æ­£å¸¸ãªå­¦ç¿’ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                resultText += `ğŸ“ˆ æ­£å¸¸å­¦ç¿’ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ†ã‚¹ãƒˆ:\n`;
                const normalPattern = [0.6, 0.65, 0.7, 0.72, 0.74];
                normalPattern.forEach((score, i) => {
                    const isOverlearning = EnhancedLearningSystem.detectOverlearning(score, true);
                    resultText += `Step ${i+1}: ã‚¹ã‚³ã‚¢ ${score} â†’ ${isOverlearning ? 'âš ï¸éå­¦ç¿’æ¤œå‡º' : 'âœ…æ­£å¸¸'}\n`;
                });
                
                // éå­¦ç¿’ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                resultText += `\nğŸš¨ éå­¦ç¿’ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ†ã‚¹ãƒˆ:\n`;
                
                // è¨“ç·´ã‚¹ã‚³ã‚¢ã‚’é«˜ãè¨­å®š
                const trainingScores = [0.7, 0.8, 0.85, 0.9, 0.95];
                trainingScores.forEach(score => {
                    EnhancedLearningSystem.detectOverlearning(score, false); // è¨“ç·´ã‚¹ã‚³ã‚¢
                });
                
                // æ¤œè¨¼ã‚¹ã‚³ã‚¢ã¯ä½ãè¨­å®šï¼ˆéå­¦ç¿’ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰
                const overfittingPattern = [0.65, 0.63, 0.6, 0.58, 0.55];
                overfittingPattern.forEach((score, i) => {
                    const isOverlearning = EnhancedLearningSystem.detectOverlearning(score, true);
                    resultText += `Step ${i+1}: æ¤œè¨¼ã‚¹ã‚³ã‚¢ ${score} â†’ ${isOverlearning ? 'âš ï¸éå­¦ç¿’æ¤œå‡º' : 'âœ…æ­£å¸¸'}\n`;
                });
                
                // å­¦ç¿’ç‡èª¿æ•´ãƒ†ã‚¹ãƒˆ
                resultText += `\nâš™ï¸ å­¦ç¿’ç‡èª¿æ•´ãƒ†ã‚¹ãƒˆ:\n`;
                const beforeRate = EnhancedLearningSystem.learningData.metaLearning.adaptationRate;
                EnhancedLearningSystem.adjustLearningRate();
                const afterRate = EnhancedLearningSystem.learningData.metaLearning.adaptationRate;
                resultText += `èª¿æ•´å‰: ${beforeRate.toFixed(3)} â†’ èª¿æ•´å¾Œ: ${afterRate.toFixed(3)}\n`;
                
                result.style.display = 'block';
                result.className = 'test-result';
                result.textContent = resultText;
                
            } catch (error) {
                result.style.display = 'block';
                result.className = 'test-result test-error';
                result.textContent = `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}\n${error.stack}`;
            }
        }
        
        // çµ±åˆãƒ†ã‚¹ãƒˆ
        function runFullTest() {
            const result = document.getElementById('fullTestResult');
            const metrics = document.getElementById('testMetrics');
            
            try {
                result.style.display = 'block';
                result.className = 'test-result';
                result.textContent = 'ğŸš€ çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...\n';
                
                // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯ç”Ÿæˆ
                if (!testData) {
                    generateTestData();
                }
                
                setTimeout(() => {
                    try {
                        let resultText = `ğŸš€ çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†\n\n`;
                        
                        // 1. ç‰¹å¾´é‡ç™ºè¦‹
                        const features = EnhancedLearningSystem.discoverFeatures(testData);
                        resultText += `ğŸ” ç‰¹å¾´é‡ç™ºè¦‹: ${Object.keys(features.features).length}å€‹ã®ç‰¹å¾´é‡ã‚’ç™ºè¦‹\n`;
                        
                        // 2. ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«äºˆæ¸¬
                        const ensemble = EnhancedLearningSystem.ensemblePredict(testData);
                        resultText += `ğŸ¯ ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«äºˆæ¸¬: ä¿¡é ¼åº¦ ${(ensemble.confidence * 100).toFixed(1)}%\n`;
                        
                        // 3. ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
                        const cvData = Array.from({length: 30}, () => ({
                            features: { odds: Math.random() * 20 + 1 },
                            actual: Math.random() > 0.7
                        }));
                        const cv = EnhancedLearningSystem.performCrossValidation(cvData);
                        resultText += `âœ… ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³: æ¤œè¨¼ã‚¹ã‚³ã‚¢ ${(cv.validationScore * 100).toFixed(1)}%\n`;
                        
                        // 4. éå­¦ç¿’æ¤œå‡º
                        const overlearning = EnhancedLearningSystem.detectOverlearning(cv.validationScore);
                        resultText += `âš ï¸ éå­¦ç¿’æ¤œå‡º: ${overlearning ? 'æ¤œå‡ºã‚ã‚Š' : 'æ­£å¸¸'}\n`;
                        
                        // ãƒ¡ãƒˆãƒªã‚¯ã‚¹æ›´æ–°
                        document.getElementById('featureCount').textContent = Object.keys(features.features).length;
                        document.getElementById('ensembleAccuracy').textContent = (ensemble.confidence * 100).toFixed(1) + '%';
                        document.getElementById('validationScore').textContent = (cv.validationScore * 100).toFixed(1) + '%';
                        document.getElementById('overlearningStatus').textContent = overlearning ? 'âš ï¸' : 'âœ…';
                        
                        metrics.style.display = 'grid';
                        
                        resultText += `\nğŸ“Š å…¨æ©Ÿèƒ½ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™ï¼\n`;
                        resultText += `\nğŸ‰ é«˜åº¦ãªå­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ ã¯å®Œå…¨ã«æ©Ÿèƒ½ã—ã¦ã„ã¾ã™ã€‚\n`;
                        resultText += `ã“ã®å®Ÿè£…ã«ã‚ˆã‚Šä»¥ä¸‹ãŒå¯èƒ½ã«ãªã‚Šã¾ã—ãŸ:\n`;
                        resultText += `ãƒ»è‡ªå‹•ç‰¹å¾´é‡æŠ½å‡ºã«ã‚ˆã‚‹äºˆæ¸¬ç²¾åº¦å‘ä¸Š\n`;
                        resultText += `ãƒ»è¤‡æ•°ãƒ¢ãƒ‡ãƒ«ã®çµ±åˆã«ã‚ˆã‚‹å®‰å®šã—ãŸäºˆæ¸¬\n`;
                        resultText += `ãƒ»éå­¦ç¿’é˜²æ­¢ã«ã‚ˆã‚‹å¥å…¨ãªå­¦ç¿’\n`;
                        resultText += `ãƒ»ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹ä¿¡é ¼æ€§ç¢ºä¿\n`;
                        
                        result.textContent = resultText;
                        
                    } catch (error) {
                        result.className = 'test-result test-error';
                        result.textContent = `âŒ çµ±åˆãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}\n${error.stack}`;
                    }
                }, 100);
                
            } catch (error) {
                result.style.display = 'block';
                result.className = 'test-result test-error';
                result.textContent = `âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}\n${error.stack}`;
            }
        }
        
        // çµæœã‚¯ãƒªã‚¢
        function clearResults() {
            const results = document.querySelectorAll('.test-result');
            results.forEach(result => result.style.display = 'none');
            document.getElementById('testMetrics').style.display = 'none';
            testData = null;
        }
        
        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸ§ª é«˜åº¦ãªå­¦ç¿’æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ');
            
            // EnhancedLearningSystemãŒåˆ©ç”¨å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯
            if (typeof EnhancedLearningSystem !== 'undefined') {
                console.log('âœ… EnhancedLearningSystemãŒåˆ©ç”¨å¯èƒ½ã§ã™');
            } else {
                console.error('âŒ EnhancedLearningSystemãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
            }
        });
    </script>
</body>
</html>