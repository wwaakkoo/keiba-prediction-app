<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase 3æ‡¸å¿µäº‹é …å¯¾å¿œå¾Œçµ±åˆãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f8f9fa;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 20px;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        .test-section h2 {
            color: #007bff;
            margin-bottom: 15px;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .test-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .test-warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .test-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .btn {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: linear-gradient(45deg, #0056b3, #004494);
        }
        .data-display {
            background: #f1f3f4;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #ddd;
            text-align: center;
        }
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #007bff;
        }
        .stat-label {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        .console-output {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Phase 3æ‡¸å¿µäº‹é …å¯¾å¿œå¾Œçµ±åˆãƒ†ã‚¹ãƒˆ</h1>
        
        <div class="test-section">
            <h2>ğŸ¯ 1. ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ã‚¹ã‚³ã‚¢çµ±åˆãƒ†ã‚¹ãƒˆ</h2>
            <button class="btn" onclick="testEnsembleIntegration()">ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <div id="ensembleTestResult" class="test-result"></div>
            <div id="ensembleData" class="data-display"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ“Š 2. ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ</h2>
            <button class="btn" onclick="testLogLevelControl()">ãƒ­ã‚°åˆ¶å¾¡ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <button class="btn" onclick="setProductionMode()">æœ¬ç•ªãƒ¢ãƒ¼ãƒ‰è¨­å®š</button>
            <button class="btn" onclick="setDevelopmentMode()">é–‹ç™ºãƒ¢ãƒ¼ãƒ‰è¨­å®š</button>
            <div id="logTestResult" class="test-result"></div>
            <div id="logStats" class="data-display"></div>
        </div>

        <div class="test-section">
            <h2>ğŸƒ 3. 3é€£è¤‡ãƒ»3é€£å˜æ¨å¥¨çµ±åˆãƒ†ã‚¹ãƒˆ</h2>
            <button class="btn" onclick="testTripleRecommendations()">3é€£è¤‡ãƒ»3é€£å˜ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <div id="tripleTestResult" class="test-result"></div>
            <div id="tripleData" class="data-display"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ”„ 4. Phase 1-3çµ±åˆã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ</h2>
            <button class="btn" onclick="testFullSystemIntegration()">å…¨ã‚·ã‚¹ãƒ†ãƒ çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <div id="fullTestResult" class="test-result"></div>
            <div class="stats-grid" id="systemStats"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ¯ 5. å®Ÿéš›ã®ãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆ</h2>
            <button class="btn" onclick="loadSampleRaceData()">ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿</button>
            <button class="btn" onclick="testRealRaceData()">å®Ÿãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <div id="raceTestResult" class="test-result"></div>
            <div id="raceData" class="data-display"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ“ˆ 6. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ãƒ†ã‚¹ãƒˆ</h2>
            <button class="btn" onclick="testPerformanceMonitoring()">ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            <div id="performanceTestResult" class="test-result"></div>
            <div id="performanceData" class="data-display"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ–¥ï¸ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ç›£è¦–</h2>
            <button class="btn" onclick="clearConsoleOutput()">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¯ãƒªã‚¢</button>
            <div id="consoleOutput" class="console-output"></div>
        </div>
    </div>

    <!-- å¿…è¦ãªJavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ -->
    <script src="../js/logLevelController.js"></script>
    <script src="../js/config.js"></script>
    <script src="../js/pedigreeDatabase.js"></script>
    <script src="../js/dataConverter.js"></script>
    <script src="../js/horseManager.js"></script>
    <script src="../js/dataManager.js"></script>
    <script src="../js/raceAnalysisEngine.js"></script>
    <script src="../js/predictionEngine.js"></script>
    <script src="../js/bettingRecommender.js"></script>
    <script src="../js/learningSystem.js"></script>
    <script src="../js/hybridLearningSystem.js"></script>
    <script src="../js/enhancedLearningSystem.js"></script>
    <script src="../js/learningDataMigration.js"></script>
    <script src="../js/enhancedVisualizationSystem.js"></script>
    <script src="../js/aiRecommendationService.js"></script>
    <script src="../js/profitabilityMetrics.js"></script>
    <script src="../js/investmentEfficiencyCalculator.js"></script>
    <script src="../js/underdogDiscoveryAlgorithm.js"></script>
    <script src="../js/riskReturnAnalyzer.js"></script>
    <script src="../js/profitabilityVisualizationSystem.js"></script>
    <script src="../js/errorHandlingSystem.js"></script>
    <script src="../js/systemIntegration.js"></script>
    <script src="../js/mobileInteractionHandler.js"></script>
    <script src="../js/investmentStrategy.js"></script>
    <script src="../js/enhancedRecommendationSystem.js"></script>
    <!-- Phase 1 -->
    <script src="../js/hitCriteriaSystem.js"></script>
    <script src="../js/reliabilityFilter.js"></script>
    <script src="../js/dynamicRecommendationAdjuster.js"></script>
    <!-- Phase 2 -->
    <script src="../js/riskManagementInvestmentSystem.js"></script>
    <script src="../js/kellyBettingSystem.js"></script>
    <script src="../js/profitabilityPatternAnalyzer.js"></script>
    <script src="../js/betTypeOptimizationSystem.js"></script>
    <script src="../js/drawdownControlSystem.js"></script>
    <!-- Phase 3 -->
    <script src="../js/realtimeLearningEngine.js"></script>
    <script src="../js/marketAdaptationSystem.js"></script>
    <script src="../js/multiDimensionalFeatureAnalyzer.js"></script>
    <script src="../js/abTestingSystem.js"></script>
    <script src="../js/raceSpecificAdaptationSystem.js"></script>

    <script>
        // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ç›£è¦–
        let consoleOutput = document.getElementById('consoleOutput');
        let originalConsoleLog = console.log;
        let originalConsoleError = console.error;
        let originalConsoleWarn = console.warn;
        let originalConsoleInfo = console.info;

        function interceptConsole() {
            console.log = function(...args) {
                originalConsoleLog.apply(console, args);
                consoleOutput.textContent += `[LOG] ${args.join(' ')}\n`;
                consoleOutput.scrollTop = consoleOutput.scrollHeight;
            };

            console.error = function(...args) {
                originalConsoleError.apply(console, args);
                consoleOutput.textContent += `[ERROR] ${args.join(' ')}\n`;
                consoleOutput.scrollTop = consoleOutput.scrollHeight;
            };

            console.warn = function(...args) {
                originalConsoleWarn.apply(console, args);
                consoleOutput.textContent += `[WARN] ${args.join(' ')}\n`;
                consoleOutput.scrollTop = consoleOutput.scrollHeight;
            };

            console.info = function(...args) {
                originalConsoleInfo.apply(console, args);
                consoleOutput.textContent += `[INFO] ${args.join(' ')}\n`;
                consoleOutput.scrollTop = consoleOutput.scrollHeight;
            };
        }

        function clearConsoleOutput() {
            consoleOutput.textContent = '';
        }

        // 1. ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ã‚¹ã‚³ã‚¢çµ±åˆãƒ†ã‚¹ãƒˆ
        function testEnsembleIntegration() {
            const result = document.getElementById('ensembleTestResult');
            const data = document.getElementById('ensembleData');
            
            try {
                console.log('ğŸ¯ ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ã‚¹ã‚³ã‚¢çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ä½œæˆ
                const sampleHorses = [
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«1', odds: 2.5, popularity: 1, age: 4, weight: 460, jockey: 'Aé¨æ‰‹', runningStyle: 'é€ƒã’' },
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«2', odds: 4.2, popularity: 2, age: 5, weight: 470, jockey: 'Bé¨æ‰‹', runningStyle: 'å…ˆè¡Œ' },
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«3', odds: 8.1, popularity: 3, age: 3, weight: 450, jockey: 'Cé¨æ‰‹', runningStyle: 'å·®ã—' },
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«4', odds: 12.3, popularity: 4, age: 6, weight: 480, jockey: 'Dé¨æ‰‹', runningStyle: 'è¿½è¾¼' },
                    { name: 'ã‚µãƒ³ãƒ—ãƒ«5', odds: 15.7, popularity: 5, age: 4, weight: 465, jockey: 'Eé¨æ‰‹', runningStyle: 'å·®ã—' }
                ];
                
                // äºˆæ¸¬å®Ÿè¡Œ
                const engine = new PredictionEngine();
                const predictions = engine.predict(sampleHorses);
                
                // ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã®æ¤œè¨¼
                const ensembleData = window.lastEnsembleResult;
                
                if (ensembleData) {
                    console.log('âœ… ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿å–å¾—æˆåŠŸ');
                    
                    // ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
                    if (ensembleData.predictions.length === predictions.length) {
                        console.log('âœ… äºˆæ¸¬æ•°ä¸€è‡´');
                        
                        // å„äºˆæ¸¬ã®çµ±åˆçŠ¶æ³ãƒã‚§ãƒƒã‚¯
                        let integrationSuccess = true;
                        predictions.forEach((pred, index) => {
                            if (pred.enhancedScore && pred.ensembleConfidence) {
                                console.log(`âœ… ${pred.name}: çµ±åˆå®Œäº† (å¼·åŒ–ã‚¹ã‚³ã‚¢: ${pred.enhancedScore.toFixed(1)}, ä¿¡é ¼åº¦: ${pred.ensembleConfidence.toFixed(3)})`);
                            } else {
                                console.warn(`âš ï¸ ${pred.name}: çµ±åˆä¸å®Œå…¨`);
                                integrationSuccess = false;
                            }
                        });
                        
                        if (integrationSuccess) {
                            result.className = 'test-result test-success';
                            result.textContent = 'âœ… ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ã‚¹ã‚³ã‚¢çµ±åˆãƒ†ã‚¹ãƒˆ: æˆåŠŸ';
                        } else {
                            result.className = 'test-result test-warning';
                            result.textContent = 'âš ï¸ ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ã‚¹ã‚³ã‚¢çµ±åˆãƒ†ã‚¹ãƒˆ: éƒ¨åˆ†çš„æˆåŠŸ';
                        }
                    } else {
                        result.className = 'test-result test-error';
                        result.textContent = 'âŒ ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ã‚¹ã‚³ã‚¢çµ±åˆãƒ†ã‚¹ãƒˆ: äºˆæ¸¬æ•°ä¸ä¸€è‡´';
                    }
                } else {
                    result.className = 'test-result test-error';
                    result.textContent = 'âŒ ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ã‚¹ã‚³ã‚¢çµ±åˆãƒ†ã‚¹ãƒˆ: ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿å–å¾—å¤±æ•—';
                }
                
                // çµæœè¡¨ç¤º
                data.textContent = JSON.stringify({
                    predictions: predictions.map(p => ({
                        name: p.name,
                        winProbability: p.winProbability,
                        enhancedScore: p.enhancedScore,
                        ensembleConfidence: p.ensembleConfidence
                    })),
                    ensembleData: ensembleData
                }, null, 2);
                
            } catch (error) {
                console.error('âŒ ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«çµ±åˆãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                result.className = 'test-result test-error';
                result.textContent = 'âŒ ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ã‚¹ã‚³ã‚¢çµ±åˆãƒ†ã‚¹ãƒˆ: ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ';
                data.textContent = error.message;
            }
        }

        // 2. ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ
        function testLogLevelControl() {
            const result = document.getElementById('logTestResult');
            const stats = document.getElementById('logStats');
            
            try {
                console.log('ğŸ“Š ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                // ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ã®å­˜åœ¨ç¢ºèª
                if (typeof LogLevelController !== 'undefined') {
                    console.log('âœ… ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ èª­ã¿è¾¼ã¿æˆåŠŸ');
                    
                    // å„ãƒ¬ãƒ™ãƒ«ã®ãƒ†ã‚¹ãƒˆ
                    LogLevelController.setLogLevel('DEBUG');
                    LogLevelController.debug('testSystem', 'ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ãƒ†ã‚¹ãƒˆ');
                    
                    LogLevelController.setLogLevel('INFO');
                    LogLevelController.info('testSystem', 'æƒ…å ±ãƒ­ã‚°ãƒ†ã‚¹ãƒˆ');
                    
                    LogLevelController.setLogLevel('WARN');
                    LogLevelController.warn('testSystem', 'è­¦å‘Šãƒ­ã‚°ãƒ†ã‚¹ãƒˆ');
                    
                    LogLevelController.setLogLevel('ERROR');
                    LogLevelController.error('testSystem', 'ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ãƒ†ã‚¹ãƒˆ');
                    
                    // çµ±è¨ˆæƒ…å ±å–å¾—
                    const logStats = LogLevelController.getLogStats();
                    console.log('âœ… ãƒ­ã‚°çµ±è¨ˆæƒ…å ±å–å¾—æˆåŠŸ');
                    
                    result.className = 'test-result test-success';
                    result.textContent = 'âœ… ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ: æˆåŠŸ';
                    
                    stats.textContent = JSON.stringify(logStats, null, 2);
                } else {
                    result.className = 'test-result test-error';
                    result.textContent = 'âŒ ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ: ã‚·ã‚¹ãƒ†ãƒ æœªèª­ã¿è¾¼ã¿';
                }
                
            } catch (error) {
                console.error('âŒ ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«åˆ¶å¾¡ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                result.className = 'test-result test-error';
                result.textContent = 'âŒ ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ: ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ';
                stats.textContent = error.message;
            }
        }

        // 3. 3é€£è¤‡ãƒ»3é€£å˜æ¨å¥¨çµ±åˆãƒ†ã‚¹ãƒˆ
        function testTripleRecommendations() {
            const result = document.getElementById('tripleTestResult');
            const data = document.getElementById('tripleData');
            
            try {
                console.log('ğŸƒ 3é€£è¤‡ãƒ»3é€£å˜æ¨å¥¨çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
                const sampleHorses = [
                    { name: 'ãƒ†ã‚¹ãƒˆ1', odds: 2.1, popularity: 1, age: 4, weight: 460 },
                    { name: 'ãƒ†ã‚¹ãƒˆ2', odds: 3.5, popularity: 2, age: 5, weight: 470 },
                    { name: 'ãƒ†ã‚¹ãƒˆ3', odds: 7.2, popularity: 3, age: 3, weight: 450 },
                    { name: 'ãƒ†ã‚¹ãƒˆ4', odds: 12.8, popularity: 4, age: 6, weight: 480 },
                    { name: 'ãƒ†ã‚¹ãƒˆ5', odds: 18.3, popularity: 5, age: 4, weight: 465 }
                ];
                
                // äºˆæ¸¬å®Ÿè¡Œ
                const engine = new PredictionEngine();
                const predictions = engine.predict(sampleHorses);
                
                // æ¨å¥¨ç”Ÿæˆ
                BettingRecommender.generateBettingRecommendations(predictions);
                
                // 3é€£è¤‡ãƒ»3é€£å˜æ¨å¥¨ã®å­˜åœ¨ç¢ºèª
                const recommendations = window.lastBettingRecommendations;
                if (recommendations) {
                    const tripleBoxRecs = recommendations.filter(r => r.category === '3é€£è¤‡');
                    const tripleExactRecs = recommendations.filter(r => r.category === '3é€£å˜');
                    
                    console.log(`âœ… 3é€£è¤‡æ¨å¥¨: ${tripleBoxRecs.length}ä»¶`);
                    console.log(`âœ… 3é€£å˜æ¨å¥¨: ${tripleExactRecs.length}ä»¶`);
                    
                    if (tripleBoxRecs.length > 0 && tripleExactRecs.length > 0) {
                        result.className = 'test-result test-success';
                        result.textContent = 'âœ… 3é€£è¤‡ãƒ»3é€£å˜æ¨å¥¨çµ±åˆãƒ†ã‚¹ãƒˆ: æˆåŠŸ';
                        
                        data.textContent = JSON.stringify({
                            tripleBox: tripleBoxRecs,
                            tripleExact: tripleExactRecs
                        }, null, 2);
                    } else {
                        result.className = 'test-result test-warning';
                        result.textContent = 'âš ï¸ 3é€£è¤‡ãƒ»3é€£å˜æ¨å¥¨çµ±åˆãƒ†ã‚¹ãƒˆ: æ¨å¥¨ç”Ÿæˆä¸å®Œå…¨';
                    }
                } else {
                    result.className = 'test-result test-error';
                    result.textContent = 'âŒ 3é€£è¤‡ãƒ»3é€£å˜æ¨å¥¨çµ±åˆãƒ†ã‚¹ãƒˆ: æ¨å¥¨ãƒ‡ãƒ¼ã‚¿å–å¾—å¤±æ•—';
                }
                
            } catch (error) {
                console.error('âŒ 3é€£è¤‡ãƒ»3é€£å˜ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                result.className = 'test-result test-error';
                result.textContent = 'âŒ 3é€£è¤‡ãƒ»3é€£å˜æ¨å¥¨çµ±åˆãƒ†ã‚¹ãƒˆ: ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ';
                data.textContent = error.message;
            }
        }

        // 4. Phase 1-3çµ±åˆã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ
        function testFullSystemIntegration() {
            const result = document.getElementById('fullTestResult');
            const statsContainer = document.getElementById('systemStats');
            
            try {
                console.log('ğŸ”„ Phase 1-3çµ±åˆã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                // å„Phaseã‚·ã‚¹ãƒ†ãƒ ã®å­˜åœ¨ç¢ºèª
                const phase1Systems = [
                    { name: 'HitCriteriaSystem', check: () => typeof HitCriteriaSystem !== 'undefined' },
                    { name: 'ReliabilityFilter', check: () => typeof ReliabilityFilter !== 'undefined' },
                    { name: 'DynamicRecommendationAdjuster', check: () => typeof DynamicRecommendationAdjuster !== 'undefined' }
                ];
                
                const phase2Systems = [
                    { name: 'RiskManagementInvestmentSystem', check: () => typeof RiskManagementInvestmentSystem !== 'undefined' },
                    { name: 'KellyBettingSystem', check: () => typeof KellyBettingSystem !== 'undefined' },
                    { name: 'ProfitabilityPatternAnalyzer', check: () => typeof ProfitabilityPatternAnalyzer !== 'undefined' }
                ];
                
                const phase3Systems = [
                    { name: 'RealtimeLearningEngine', check: () => typeof RealtimeLearningEngine !== 'undefined' },
                    { name: 'MarketAdaptationSystem', check: () => typeof MarketAdaptationSystem !== 'undefined' },
                    { name: 'MultiDimensionalFeatureAnalyzer', check: () => typeof MultiDimensionalFeatureAnalyzer !== 'undefined' }
                ];
                
                // ã‚·ã‚¹ãƒ†ãƒ çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
                const testResults = {
                    phase1: phase1Systems.map(s => ({ name: s.name, available: s.check() })),
                    phase2: phase2Systems.map(s => ({ name: s.name, available: s.check() })),
                    phase3: phase3Systems.map(s => ({ name: s.name, available: s.check() }))
                };
                
                // çµ±è¨ˆè¡¨ç¤º
                statsContainer.innerHTML = '';
                Object.keys(testResults).forEach(phase => {
                    const phaseResults = testResults[phase];
                    const available = phaseResults.filter(r => r.available).length;
                    const total = phaseResults.length;
                    
                    const statItem = document.createElement('div');
                    statItem.className = 'stat-item';
                    statItem.innerHTML = `
                        <div class="stat-value">${available}/${total}</div>
                        <div class="stat-label">${phase.toUpperCase()} ã‚·ã‚¹ãƒ†ãƒ </div>
                    `;
                    statsContainer.appendChild(statItem);
                });
                
                // ç·åˆåˆ¤å®š
                const totalAvailable = Object.values(testResults).flat().filter(r => r.available).length;
                const totalSystems = Object.values(testResults).flat().length;
                
                if (totalAvailable === totalSystems) {
                    result.className = 'test-result test-success';
                    result.textContent = 'âœ… Phase 1-3çµ±åˆã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ: å…¨ã‚·ã‚¹ãƒ†ãƒ æ­£å¸¸';
                } else if (totalAvailable > totalSystems * 0.8) {
                    result.className = 'test-result test-warning';
                    result.textContent = 'âš ï¸ Phase 1-3çµ±åˆã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ: ä¸€éƒ¨ã‚·ã‚¹ãƒ†ãƒ ä¸å®Œå…¨';
                } else {
                    result.className = 'test-result test-error';
                    result.textContent = 'âŒ Phase 1-3çµ±åˆã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ: é‡è¦ã‚·ã‚¹ãƒ†ãƒ ä¸è¶³';
                }
                
            } catch (error) {
                console.error('âŒ çµ±åˆã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                result.className = 'test-result test-error';
                result.textContent = 'âŒ Phase 1-3çµ±åˆã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ: ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ';
            }
        }

        // ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
        function loadSampleRaceData() {
            const data = document.getElementById('raceData');
            
            const sampleRaceData = [
                { name: 'å®Ÿæˆ¦ãƒ†ã‚¹ãƒˆ1', odds: 1.8, popularity: 1, age: 4, weight: 460, jockey: 'M.ãƒ‡ãƒ ãƒ¼ãƒ­', runningStyle: 'é€ƒã’' },
                { name: 'å®Ÿæˆ¦ãƒ†ã‚¹ãƒˆ2', odds: 3.2, popularity: 2, age: 5, weight: 470, jockey: 'C.ãƒ«ãƒ¡ãƒ¼ãƒ«', runningStyle: 'å…ˆè¡Œ' },
                { name: 'å®Ÿæˆ¦ãƒ†ã‚¹ãƒˆ3', odds: 5.8, popularity: 3, age: 3, weight: 450, jockey: 'æ­¦è±Š', runningStyle: 'å·®ã—' },
                { name: 'å®Ÿæˆ¦ãƒ†ã‚¹ãƒˆ4', odds: 8.9, popularity: 4, age: 6, weight: 480, jockey: 'ç¦æ°¸ç¥ä¸€', runningStyle: 'è¿½è¾¼' },
                { name: 'å®Ÿæˆ¦ãƒ†ã‚¹ãƒˆ5', odds: 13.2, popularity: 5, age: 4, weight: 465, jockey: 'æˆ¸å´åœ­å¤ª', runningStyle: 'å·®ã—' },
                { name: 'å®Ÿæˆ¦ãƒ†ã‚¹ãƒˆ6', odds: 21.7, popularity: 6, age: 5, weight: 475, jockey: 'å·ç”°å°†é›…', runningStyle: 'è¿½è¾¼' },
                { name: 'å®Ÿæˆ¦ãƒ†ã‚¹ãƒˆ7', odds: 34.1, popularity: 7, age: 3, weight: 455, jockey: 'å²©ç”°åº·èª ', runningStyle: 'å…ˆè¡Œ' },
                { name: 'å®Ÿæˆ¦ãƒ†ã‚¹ãƒˆ8', odds: 67.3, popularity: 8, age: 7, weight: 485, jockey: 'æ± æ·»è¬™ä¸€', runningStyle: 'è¿½è¾¼' }
            ];
            
            window.testRaceData = sampleRaceData;
            data.textContent = JSON.stringify(sampleRaceData, null, 2);
            console.log('âœ… ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†');
        }

        // å®Ÿãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆ
        function testRealRaceData() {
            const result = document.getElementById('raceTestResult');
            const data = document.getElementById('raceData');
            
            try {
                console.log('ğŸ¯ å®Ÿãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                if (!window.testRaceData) {
                    loadSampleRaceData();
                }
                
                // äºˆæ¸¬å®Ÿè¡Œ
                const engine = new PredictionEngine();
                const predictions = engine.predict(window.testRaceData);
                
                // æ¨å¥¨ç”Ÿæˆ
                BettingRecommender.generateBettingRecommendations(predictions);
                
                // çµæœæ¤œè¨¼
                const recommendations = window.lastBettingRecommendations;
                if (recommendations && recommendations.length > 0) {
                    const categories = [...new Set(recommendations.map(r => r.category))];
                    console.log(`âœ… æ¨å¥¨ã‚«ãƒ†ã‚´ãƒª: ${categories.join(', ')}`);
                    
                    result.className = 'test-result test-success';
                    result.textContent = `âœ… å®Ÿãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆ: æˆåŠŸ (${recommendations.length}ä»¶æ¨å¥¨)`;
                    
                    data.textContent = JSON.stringify({
                        predictions: predictions.map(p => ({
                            name: p.name,
                            winProbability: p.winProbability,
                            enhancedScore: p.enhancedScore
                        })),
                        recommendations: recommendations.map(r => ({
                            category: r.category,
                            type: r.type,
                            confidence: r.confidence
                        }))
                    }, null, 2);
                } else {
                    result.className = 'test-result test-error';
                    result.textContent = 'âŒ å®Ÿãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆ: æ¨å¥¨ç”Ÿæˆå¤±æ•—';
                }
                
            } catch (error) {
                console.error('âŒ å®Ÿãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                result.className = 'test-result test-error';
                result.textContent = 'âŒ å®Ÿãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆ: ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ';
                data.textContent = error.message;
            }
        }

        // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ãƒ†ã‚¹ãƒˆ
        function testPerformanceMonitoring() {
            const result = document.getElementById('performanceTestResult');
            const data = document.getElementById('performanceData');
            
            try {
                console.log('ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                const startTime = performance.now();
                
                // è¤‡æ•°å›ã®äºˆæ¸¬å®Ÿè¡Œã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®š
                const iterations = 10;
                const times = [];
                
                for (let i = 0; i < iterations; i++) {
                    const iterationStart = performance.now();
                    
                    const sampleHorses = Array.from({length: 8}, (_, index) => ({
                        name: `ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ${index + 1}`,
                        odds: Math.random() * 20 + 1,
                        popularity: index + 1,
                        age: Math.floor(Math.random() * 5) + 3,
                        weight: Math.floor(Math.random() * 50) + 450
                    }));
                    
                    const engine = new PredictionEngine();
                    const predictions = engine.predict(sampleHorses);
                    BettingRecommender.generateBettingRecommendations(predictions);
                    
                    const iterationEnd = performance.now();
                    times.push(iterationEnd - iterationStart);
                }
                
                const totalTime = performance.now() - startTime;
                const avgTime = times.reduce((a, b) => a + b, 0) / times.length;
                const maxTime = Math.max(...times);
                const minTime = Math.min(...times);
                
                const performanceStats = {
                    iterations: iterations,
                    totalTime: `${totalTime.toFixed(2)}ms`,
                    averageTime: `${avgTime.toFixed(2)}ms`,
                    maxTime: `${maxTime.toFixed(2)}ms`,
                    minTime: `${minTime.toFixed(2)}ms`,
                    throughput: `${(iterations / (totalTime / 1000)).toFixed(2)} predictions/sec`
                };
                
                if (avgTime < 100) {
                    result.className = 'test-result test-success';
                    result.textContent = 'âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ãƒ†ã‚¹ãƒˆ: è‰¯å¥½';
                } else if (avgTime < 200) {
                    result.className = 'test-result test-warning';
                    result.textContent = 'âš ï¸ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ãƒ†ã‚¹ãƒˆ: æ³¨æ„';
                } else {
                    result.className = 'test-result test-error';
                    result.textContent = 'âŒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ãƒ†ã‚¹ãƒˆ: è¦æ”¹å–„';
                }
                
                data.textContent = JSON.stringify(performanceStats, null, 2);
                
            } catch (error) {
                console.error('âŒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                result.className = 'test-result test-error';
                result.textContent = 'âŒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ãƒ†ã‚¹ãƒˆ: ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ';
                data.textContent = error.message;
            }
        }

        // ãƒ­ã‚°ãƒ¢ãƒ¼ãƒ‰è¨­å®š
        function setProductionMode() {
            if (typeof LogLevelController !== 'undefined') {
                LogLevelController.setProductionMode();
                console.log('ğŸ­ æœ¬ç•ªãƒ¢ãƒ¼ãƒ‰ã«è¨­å®šã—ã¾ã—ãŸ');
            }
        }

        function setDevelopmentMode() {
            if (typeof LogLevelController !== 'undefined') {
                LogLevelController.setDevelopmentMode();
                console.log('ğŸ”§ é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã«è¨­å®šã—ã¾ã—ãŸ');
            }
        }

        // åˆæœŸåŒ–
        window.onload = function() {
            console.log('ğŸ” Phase 3æ‡¸å¿µäº‹é …å¯¾å¿œå¾Œçµ±åˆãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†');
            interceptConsole();
            
            // ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ã®åˆæœŸåŒ–ç¢ºèª
            if (typeof LogLevelController !== 'undefined') {
                console.log('âœ… ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ åˆ©ç”¨å¯èƒ½');
                LogLevelController.setPerformanceMode();
            }
        };
    </script>
</body>
</html>